<!DOCTYPE HTML>
<html class="no-js" lang>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>mfin-uat.vizru.com-vizru</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/jquery-ui.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/jquery-ui-1.10.0.custom.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/handsontable.full.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/jquery.ui.plupload.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/jquery.plupload.queue.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/jquery.multiselect.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/jquery.multiselect.filter.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/tribute.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/dashboardChat.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/bootstrap.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/font-awesome.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/style.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/perfect-scrollbar.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/select.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/jquery.fancybox.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/unicorn.main.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/zaplet.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/unicorn.grey.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/token-input.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/token-input-facebook.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/daterangepicker.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/layoutit.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/animate.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/base.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/goldenlayout-base.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/goldenlayout-light-theme.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/colors-green.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/media-query.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/jquery.gridster.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/gridster.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/vizru-themes.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/split-pane.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/bootstrap-tour.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/mediaelementplayer.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/bootstrap-datetimepicker.min.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/jquery.jsonview.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/stylesheet.css">
    <link class="css" type="text/css" rel="stylesheet" media="all" href="css/chat-ui-icomoon.css">
    <link href="css/css.css" rel="stylesheet" type="text/css">
    <link href="css/css_1.css" rel="stylesheet">
    <!--[if lt IE 9]><script class="js" type="text/javascript" src="/ui-themes/base/scripts/libs/jquery-1.9.1.min.js"></script><![endif]-->
    <!--[if gte IE 9]><!-->
    <script class="js" type="text/javascript" src="js/jquery-2.0.0.min.js"></script>
    <!--<![endif]-->
    <script class="js" type="text/javascript" src="js/head.js"></script>
    <script>var meessageArray = ["Just a few more seconds", ""];</script>
</head>

<body class="sidebar-small tenant-mfin-uat.vizru.com domain-  tableline viz-sidebar viz-sidebar-small viz-black-sidebar-skin">
    <div id="messages" class="messages"></div>
    <div id="viznotification" class="viz-notification"></div>
    <div id="notificationContainer" class="viz-notificationContainer"></div>
    <div id="headerWrap">
        <header>
            <div class="logoDrop rightMenu"><a id="vizrulogo" class="dropdown-toggle tip-bottom vizru-logo" data-toggle="dropdown" href="#" data-ahref="/#user.home"><img src="fonts/vizru-logo-shape-white.svg" alt="Vizru's Logo" class="vizru-logo-small"><img src="fonts/vizru-logo-white.svg" alt="Vizru's Logo" class="vizru-logo-large"></a>
                <div class="dropdown-menu pull-left appMainDropDown" aria-labelledby="dropdownMenuLink2">
                    <ul>
                        <li class="protop" style="border-bottom:solid 1px #eee;">
                            <figure class="imageProfile"><img src="images/no-image2.jpg"></figure><strong class="email">lucas@vizru.com </strong>
                        </li>
                        <li class="lsLinks dropdown-submenu"> <span class="caret lsCaret"></span><a href="#ls/livespace.list"><i class="im icon-ls-coud"></i><span class="lsName">My Apps</span>
                                <section> Switch App Container </section>
                            </a>
                            <div class="dropDownMenu myappMenu dropdown-menu" id="lsmenu" style="left:235px;left: 235px; zoom: 1;top: -147px;min-height: 366px;overflow: hidden;"> </div>
                        </li>
                        <li role="separator" class="divider mt0"></li>
                        <li> <a href="/#user/myprofile.view" class><i class="im icon-user"></i> <span>My Profile</span></a> </li>
                        <li><a href="/#user/administer.list" title="Users"><i class="im icon-user"> </i><span>Invite People</span></a></li>
                        <li><a title="Impersonate User" class="ajax" href="/user/impersonation.impersonate"><i class="im icon-user"></i> <span>Impersonate User</span></a> </li>
                        <li><a title="Change Password" class=" ajax" href="/user/myprofile/password.change"><i class="im icon-key"></i> <span>Change Password</span></a></li>
                        <li style=" border-top: 1px solid #eee;"><a title="Sign Out" class="smallIcon" href="/user.signout"><i class="im icon-signout"></i> Sign Out</a> </li>
                    </ul>
                </div>
            </div>
            <div class="rightMenu viz-sidebar-bottom-navs">
                <ul class="menu nav nav-pills">
                    <li class="dropdown dropup dropdown dropdown-on-body" id="support"><a title="Support" class="tip-right circleHoverItem-after" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="im icon-support"></i></a>
                        <div class="dropdown-menu onBody-dropdown" aria-labelledby="dropdownMenuLink2">
                            <ul data-identifier="tourDrop">
                                <li class="tourCreateOl"></li>
                                <li class="dropdown dropup " id="tour"><a id="tourLinks" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="im icon-tour" style="font-size: 1.35em;" aria-hidden="true"></i><span>Custom Tours</span></a>
                                    <ul class="tourlist dropdownBelow dropdown-menu"></ul>
                                </li>
                                <li><a class="ajax" href="/vizru/support/issues.new" title="Report an Issue"> <i class="im icon-support"></i> <span>Vizru Customer Support</span></a></li>
                            </ul>
                        </div>
                    </li>
                    <li id="settingsLinks" class="settingsLinks dropup dropdown dropdown-on-body"><a title="Settings" class="tip-right circleHoverItem-after" href="javascript:void(0)" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="im icon-cogwheel"></i></a>
                        <div class=" dropdown-menu onBody-dropdown" aria-labelledby="dropdownMenuLink2">
                            <ul data-identifier="settingsDrop">
                                <li><a href="/#workflow.html" title="Stencil"><i class="im icon-block"> </i><span>Manage Stencils</span></a></li>
                                <li><a href="/#workflow/log.html" title="Stencil Logs"><i class="im icon-doc"> </i><span>Stencils Logs</span></a></li>
                                <li><a href="/#settings.html" title="Global Settings"><i class="im icon-cogwheel"> </i><span>Configure Policies</span></a></li>
                                <li><a href="/#livecloud/apps.html" title="Cloud Services"><i class="icon-cloud-service"> </i><span>Cloud Services</span></a></li>
                                <li><a href="/#livecloud/externaldata.html" title="Receiver"><i class="im icon-power-cord"> </i><span>Configure Receiver</span></a></li>
                                <li><a href="/#storage/conf.html" title="Storage"><i class="im icon-storage"> </i><span>Manage Storage</span></a></li><!-- <li><a href="/#workflow/log.html" title="Monitor"><i class="im icon-monitor"> </i><span>Monitor</span></a></li>-->
                            </ul>
                        </div>
                    </li>
                </ul>
                <div class="sidebar-collapsible-icon-wrap">
                    <div class="sidebar-collapsible-icon circleHoverItem-after"><i class="icon-arrow-collapse"></i></div>
                </div>
            </div>
            <script>(function () {var dropdownMenu;$('body').on('show.bs.dropdown', function (e) {dropdownMenu = $(e.target).find('.dropdown-menu.onBody-dropdown');dropidentifier = $(e.target).find('ul').attr("data-identifier");$('body').append(dropdownMenu.detach());var eOffset = $(e.target).offset();dropdownMenu.css({'display': 'block','position': 'fixed','overflow-y': 'auto','top': eOffset.top + $(e.target).outerHeight(),'left': eOffset.left + $(e.target).outerWidth() - 240,'max-height': $(window).height() - $(e.target).offset().top - $(e.target).height() - 2 + 'px'});dropdownMenu.addClass(dropidentifier);});$('body').on('hide.bs.dropdown', ".dropdown-on-body", function (e) {$(e.target).append(dropdownMenu.detach());dropdownMenu.hide();});})();//  $(".isDashboardView").on('scroll',function(e){//   if($("body > ul.onBody-dropdown:last-child").length){//         $("body").click();//     }// });</script>
        </header>
    </div>
    <section id="ls" class="contentInner   htmltpl ">
        <section id="headerBelow" class="container-fluid" style="left: 0px">
            <div class="headerBelowButtonLeft pull-left">
                <ul class="links nav nav-pills">
                    <li>
                        <h1>test_workspace</h1>
                    </li>
                </ul>
            </div>
        </section>
        <div id="content" class="row-fluid cardParent isDashboardView isDash liveapps_dashboard nodashEdit">
            <div class="flttab-but2"> </div>
            <div id="hide-all" style="display:none;"><i class="icon-spinner icon-spin icon-large clr_white font_24"></i><i class="clr_white font_24"> Loading....</i> </div>
            <div class="filterByLiveapp">
                <div class="item_ dropdown">2546</div>
            </div>
            <div id="contents" class="tab-content clearfix">
                <span class="filtrCountPoscls filtCounting">1</span>
                <ul class="nav nav-tabs mb0  overHeader headerBelowTabOverlap " id="reportTabEdit">
                    <li class="active tab1 ">
                        <a class="tabItem " data-tabid="188-49-1" data-tabcount="1" href="#tab1">Tab 1</a>
                    </li>
                    <li class=" tab2">
                        <a class="tabItem " data-tabid="188-49-2" data-tabcount="2" href="#tab2">Ledger Data</a>
                    </li>
                    <li class=" tab3">
                        <a class="tabItem " data-tabid="188-49-3" data-tabcount="3" href="#tab3">Charts</a>
                    </li>
                    <li class=" tab4">
                        <a class="tabItem " data-tabid="188-49-4" data-tabcount="4" href="#tab4">DynamicTab</a>
                    </li>
                </ul>
                <div class="tab-pane  active" id="tab1">
                    <div class=" ">
                        <div class="row-fluid  clearfix ">
                            <div class="gridster">
                                <ul>
                                    <li class="gs-w spreadsheet" data-sizey="5" data-sizex="12" data-col="1" data-row="1" data-autoheight="false">
                                        <div class="gridster-box">
                                            <div class="tName ">
                                                <div class="dashboard-element-name"> TempClientInformations </div>
                                                <span class="icon_  bor_no justExcel spreadsheet">
                                                    <a class="icon-resize-full fro mr10 tip" href="#image-476" title="Resize.Window"></a>
                                                    <input type="hidden" id="fileColId-49-476-1-0-1_1" value="1293#188-476">
                                                </span>
                                            </div>
                                            <div data-sizey="5" class="objectContent" data-id="49-476">
                                                <script>
                                                    if(typeof hot3 === 'undefined'){    
    var hot3 = [];
}
if(typeof hot3Conf === 'undefined'){
       var hot3Conf = [];
}
if(typeof lapSS === 'undefined'){
   var lapSS = [];
};

var SPdata;
var generalSettings;
var validateColumnFunctionObj = {};
var lastKeyCode ;
var isRep;

if($('.container-fluid').hasClass('isLsSpreadSheet')){
  isRep = $('.isLsSpreadSheet').find('#isReport').val();
}else{
  isRep = $('.isLsSheet').find('#isReport').val();
}
$(document).ready(function () {

 }); 
 

function handsontableMoveToFirstRow( ssid ) {
  hot3[ssid].selectCell(1,1);
}; 

function handsontableMoveToLastRow( ssid ) {

  var rowCount        = hot3[ssid].countRows();

  while(hot3[ssid].getDataAtCell(rowCount,0) == null){
    rowCount = rowCount - 1;
  }
  hot3[ssid].selectCell( rowCount ,1);
  var shtid           = '#sheet-'+ssid;
  var spanshtid           = '#topmenubar-'+ssid;
  $(shtid).find('td.current').attr('id', 'endrow');
  $(shtid).find('.wtHolder').animate({
        scrollTop:3000
    }, 10, function(){ 
      $(shtid).find('td.current').removeAttr('id',"#endrow");
    } );
};

function handsontableAddNewRow( ssid ) {

  var rowCount        = hot3[ssid].countRows();

  while(hot3[ssid].getDataAtCell(rowCount,0) == null){
    rowCount = rowCount - 1;
  }
  hot3[ssid].selectCell( rowCount+1 ,1);

  var shtid           = '#sheet-'+ssid;
  var spanshtid       = '#topmenubar-'+ssid;
  $(shtid).find('td.current').attr('id', 'endrow');

/* window.location     = '#endrow';*/
  $(shtid).find('td.current').removeAttr('id');  
};

function handsontableWrapTextToggle( ssid ) {
  var shtid           = '#sheet-'+ssid;
  $(shtid).toggleClass('wraptext');
  
};


function handsontableRowHistory( obj_id, ssid_str ) {
  //var isRep         = $('#isReport').val();
  if(isRep != '1'){
    var obj_id      = $('#ssid').val();
    var setngsssid  = $('#ssid').val();
  }else{
    var obj_id      = $.trim(obj_id);
    var res         = $.trim(ssid_str).split("-");
    var setngsssid  = res[0];
  }

  if(setngsssid != ''){
  
    var setRowIndx  = hot3[obj_id].getSelected()[0];
    var tmpRowId    = hot3[obj_id].getDataAtCell(setRowIndx, 0);
    var setUrl      = '/ls/livespace/spreadsheet/audittrail.html/'+setngsssid+'/'+tmpRowId+$app.queryString();
    $('#show-rowhistory-btn').attr('href',setUrl);
    $("#show-rowhistory-btn").trigger( "click" );
  }
}; 





function handsontableRowView( obj_id, ssid_str ) {
  //var isRep         = $('#isReport').val();
  if(isRep != '1'){
    var obj_id      = $('#ssid').val();
    var setngsssid  = $('#ssid').val();
  }else{
    var obj_id      = $.trim(obj_id);
    var res         = $.trim(ssid_str).split("-");
    var setngsssid  = res[0];
  }

  if(setngsssid != ''){
    var setRowIndx  = hot3[obj_id].getSelected()[0];
    var tmpRowId    = hot3[obj_id].getDataAtCell(setRowIndx, 0);
    var setUrl      = '/ls/livespace/spreadsheet.rowview/'+setngsssid+'/'+tmpRowId+$app.queryString();
    $('#show-rowview-btn').attr('href',setUrl);
    $("#show-rowview-btn").trigger( "click" );
  }
};

 


</script>
                                                <div class="container-fluid  isLsSheet   5413ce4de4e87a933ea2b6d059c3675f">
                                                    <input type="hidden" name="isReport" id="isReport" value="1">
                                                    <span style="margin-top:-100px; position:absolute;" id="topmenubar-49-476-1-0-1_1"></span>
                                                    <div class="row-fluid">
                                                        <div class="noborder   col-md-12  ssarea
        ">
                                                            <div class="clearfix ssnamedetail ">
                                                                <div class="col-md-2 pl10">
                                                                    <input type="text" placeholder="Name" id="name-5baf22088f7c443014cff18b-1-0-1_1" name="name" class="section spreadsheet form-control" value="TempClientInformations">
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <input type="text" placeholder="Description" id="desc-5baf22088f7c443014cff18b-1-0-1_1" name="desc" class="section spreadsheet form-control" value>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <span class="font_10 clr_gray ml5"></span>
                                                                    <span class="lock_cls font_10 clr_red ml5 "></span>
                                                                </div>
                                                                <a href="/ls/livespace/spreadsheet.columnsettings/49-476-1-0-1_1" data-width="500" id="slide-settings-btn" class="ajax hide"> <i title="Settings" class="icon-cog"></i></a>
                                                            </div>
                                                            <a id="show-rowhistory-btn" data-height="700px" data-width="85%" title="Row History" class="ajax hide"> <i title="RowHistory" class="icon-cog"></i></a>
                                                            <a id="show-rowview-btn" data-width="700" title="Row Detailed View" class="ajax hide"> <i title="Row Detailed View" class="icon-cog"></i></a>
                                                            <div class="clearfix">
                                                                <div class="box al clearfix">
                                                                    <div class="col-md-12 sstopmenu">
                                                                        <a class="hide">TempClien...</a>
                                                                        <a class="showHideTblCtrl"><i class="im icon-ellipsis-v"></i></a>
                                                                        <a class="tip-top hide" title="Copy"></a>
                                                                        <a class="tip-top addrow">Add Row</a>
                                                                        <a class="tip-top refreshSSData">Refresh</a>
                                                                        <a class="tip-top wraptext" onclick="handsontableWrapTextToggle('49-476-1-0-1_1');"> Wrap Text</a>
                                                                        <a class="tip-top" onclick="handsontableRowHistory('49-476-1-0-1_1', '5baf22088f7c443014cff18b-1-0-1_1');"> History</a>
                                                                        <a class="tip-top ssdownload" onclick="handsontableDownload('5baf22088f7c443014cff18b-1-0-1_1','49-476-1-0-1_1');">Download</a>
                                                                        <input type="text" style="height: 23px;margin-bottom: 3px;text-indent: 5px; width: 150px;" placeholder="search" name="name" class="ss-text-search ml10 " value autocomplete="off">
                                                                        <a class="tip-top ss-text-search-el" title=" Search"> <i class="fa fa-search ss-text-search-btn" onclick="handsontableSearchAndSort('49-476-1-0-1_1', '5baf22088f7c443014cff18b-1-0-1_1');"> </i></a>
                                                                        <select style="width:150px; height:23px; border-color: #ccc;" class="ss-sort-data noselect mt3 ml10" onclick="handsontableSearchAndSort('49-476-1-0-1_1', '5baf22088f7c443014cff18b-1-0-1_1');">
                                                                            <option value selected="selected">Sort By</option>
                                                                            <option value="SS_ROW_UPDATED_DT-asc">SS_ROW_UPDATED_DT - asc</option>
                                                                            <option value="SS_ROW_UPDATED_DT-desc">SS_ROW_UPDATED_DT - desc</option>
                                                                            <option value="e9234acb709a8e6521089fd47dada835-asc">UUID - asc</option>
                                                                            <option value="e9234acb709a8e6521089fd47dada835-desc">UUID - desc</option>
                                                                            <option value="2fbe7dad2e9b1cafab9a6c3955b8acb8-asc">UID - asc</option>
                                                                            <option value="2fbe7dad2e9b1cafab9a6c3955b8acb8-desc">UID - desc</option>
                                                                            <option value="71b72fa50983dcfd9fb816c402013979-asc">PolicyID - asc</option>
                                                                            <option value="71b72fa50983dcfd9fb816c402013979-desc">PolicyID - desc</option>
                                                                            <option value="b7bc1498f89a2fb9ceaa80e120e7e6dc-asc">BeneficaryName - asc</option>
                                                                            <option value="b7bc1498f89a2fb9ceaa80e120e7e6dc-desc">BeneficaryName - desc</option>
                                                                            <option value="53f9ad9959ca53f4c90dd410d0917bac-asc">InsuredID - asc</option>
                                                                            <option value="53f9ad9959ca53f4c90dd410d0917bac-desc">InsuredID - desc</option>
                                                                            <option value="aaad7d775915559240d39fb3baced353-asc">InsuredName - asc</option>
                                                                            <option value="aaad7d775915559240d39fb3baced353-desc">InsuredName - desc</option>
                                                                            <option value="fb3e3f2c7a4a7d813fbb23f46544ba93-asc">PrimaryInsured - asc</option>
                                                                            <option value="fb3e3f2c7a4a7d813fbb23f46544ba93-desc">PrimaryInsured - desc</option>
                                                                            <option value="0ae31cec7d6ae2f594404a3d0671af5c-asc">OwnerID - asc</option>
                                                                            <option value="0ae31cec7d6ae2f594404a3d0671af5c-desc">OwnerID - desc</option>
                                                                            <option value="a168a3d0d1bad80ef4cf6a17a68b0520-asc">Owner - asc</option>
                                                                            <option value="a168a3d0d1bad80ef4cf6a17a68b0520-desc">Owner - desc</option>
                                                                            <option value="5ab728df12883a896e5ed962411a10ce-asc">HTML - asc</option>
                                                                            <option value="5ab728df12883a896e5ed962411a10ce-desc">HTML - desc</option>
                                                                            <option value="763e12e5cd4a021122996bb82dd70296-asc">CarrierName - asc</option>
                                                                            <option value="763e12e5cd4a021122996bb82dd70296-desc">CarrierName - desc</option>
                                                                            <option value="1dab5a203162d9b073428a5488206d60-asc">PolicyPremium - asc</option>
                                                                            <option value="1dab5a203162d9b073428a5488206d60-desc">PolicyPremium - desc</option>
                                                                            <option value="03c3a289e3bfc2e34a295d73e7587dad-asc">AnnualPremium - asc</option>
                                                                            <option value="03c3a289e3bfc2e34a295d73e7587dad-desc">AnnualPremium - desc</option>
                                                                            <option value="effc1344d81d6043e7f3fd7930159445-asc">AnnualPolicyFee - asc</option>
                                                                            <option value="effc1344d81d6043e7f3fd7930159445-desc">AnnualPolicyFee - desc</option>
                                                                            <option value="849bb71e03e4f9ac4400be1c29aaf501-asc">YTDPremium - asc</option>
                                                                            <option value="849bb71e03e4f9ac4400be1c29aaf501-desc">YTDPremium - desc</option>
                                                                            <option value="10986dbce7e227d89bdbdfe36321b832-asc">CashSurrValue - asc</option>
                                                                            <option value="10986dbce7e227d89bdbdfe36321b832-desc">CashSurrValue - desc</option>
                                                                            <option value="5bccdc88a2aa4268b97ed34aae1c8975-asc">PolicyBenefit - asc</option>
                                                                            <option value="5bccdc88a2aa4268b97ed34aae1c8975-desc">PolicyBenefit - desc</option>
                                                                            <option value="59ed91b7a0e01d2bff25ac748020a2fc-asc">PolicyDate - asc</option>
                                                                            <option value="59ed91b7a0e01d2bff25ac748020a2fc-desc">PolicyDate - desc</option>
                                                                            <option value="4802b6b02a2d458a8419bc1c4a157364-asc">marked - asc</option>
                                                                            <option value="4802b6b02a2d458a8419bc1c4a157364-desc">marked - desc</option>
                                                                            <option value="65594b2896bdd492dfbaa7e14803ead0-asc">SelectBox - asc</option>
                                                                            <option value="65594b2896bdd492dfbaa7e14803ead0-desc">SelectBox - desc</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="_pan12" style="overflow:hidden">
                                                                <div class="handsontable dataTable  ssPaginateSheet " id="sheet-49-476-1-0-1_1" cnt-key="49-476" style="min-height:100px"></div>
                                                                <div class="clearfix  paginationContainer">
                                                                    <div class="paginationStatus flo mt10"> </div>
                                                                    <div class="ss-pagination  pagination fro mt10"> </div>
                                                                </div>
                                                                <a class="hide" id="btn-show-all-record">Show All Record </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="gs-w spreadsheet" data-sizey="5" data-sizex="12" data-col="1" data-row="6" data-autoheight="false">
                                        <div class="gridster-box">
                                            <div class="tName ">
                                                <div class="dashboard-element-name"> Policy Illustrations </div>
                                                <span class="icon_  bor_no justExcel spreadsheet">
                                                    <a class="icon-resize-full fro mr10 tip" href="#image-479" title="Resize.Window"></a>
                                                    <input type="hidden" id="fileColId-49-479-1-0-6_1" value="1019#188-479">
                                                </span>
                                            </div>
                                            <div data-sizey="5" class="objectContent" data-id="49-479">
                                                <script>
                                                    if(typeof hot3 === 'undefined'){    
    var hot3 = [];
}
if(typeof hot3Conf === 'undefined'){
       var hot3Conf = [];
}
if(typeof lapSS === 'undefined'){
   var lapSS = [];
};

var SPdata;
var generalSettings;
var validateColumnFunctionObj = {};
var lastKeyCode ;
var isRep;

if($('.container-fluid').hasClass('isLsSpreadSheet')){
  isRep = $('.isLsSpreadSheet').find('#isReport').val();
}else{
  isRep = $('.isLsSheet').find('#isReport').val();
}
$(document).ready(function () {

 }); 
 

function handsontableMoveToFirstRow( ssid ) {
  hot3[ssid].selectCell(1,1);
}; 

function handsontableMoveToLastRow( ssid ) {

  var rowCount        = hot3[ssid].countRows();

  while(hot3[ssid].getDataAtCell(rowCount,0) == null){
    rowCount = rowCount - 1;
  }
  hot3[ssid].selectCell( rowCount ,1);
  var shtid           = '#sheet-'+ssid;
  var spanshtid           = '#topmenubar-'+ssid;
  $(shtid).find('td.current').attr('id', 'endrow');
  $(shtid).find('.wtHolder').animate({
        scrollTop:3000
    }, 10, function(){ 
      $(shtid).find('td.current').removeAttr('id',"#endrow");
    } );
};

function handsontableAddNewRow( ssid ) {

  var rowCount        = hot3[ssid].countRows();

  while(hot3[ssid].getDataAtCell(rowCount,0) == null){
    rowCount = rowCount - 1;
  }
  hot3[ssid].selectCell( rowCount+1 ,1);

  var shtid           = '#sheet-'+ssid;
  var spanshtid       = '#topmenubar-'+ssid;
  $(shtid).find('td.current').attr('id', 'endrow');

/* window.location     = '#endrow';*/
  $(shtid).find('td.current').removeAttr('id');  
};

function handsontableWrapTextToggle( ssid ) {
  var shtid           = '#sheet-'+ssid;
  $(shtid).toggleClass('wraptext');
  
};


function handsontableRowHistory( obj_id, ssid_str ) {
  //var isRep         = $('#isReport').val();
  if(isRep != '1'){
    var obj_id      = $('#ssid').val();
    var setngsssid  = $('#ssid').val();
  }else{
    var obj_id      = $.trim(obj_id);
    var res         = $.trim(ssid_str).split("-");
    var setngsssid  = res[0];
  }

  if(setngsssid != ''){
  
    var setRowIndx  = hot3[obj_id].getSelected()[0];
    var tmpRowId    = hot3[obj_id].getDataAtCell(setRowIndx, 0);
    var setUrl      = '/ls/livespace/spreadsheet/audittrail.html/'+setngsssid+'/'+tmpRowId+$app.queryString();
    $('#show-rowhistory-btn').attr('href',setUrl);
    $("#show-rowhistory-btn").trigger( "click" );
  }
}; 





function handsontableRowView( obj_id, ssid_str ) {
  //var isRep         = $('#isReport').val();
  if(isRep != '1'){
    var obj_id      = $('#ssid').val();
    var setngsssid  = $('#ssid').val();
  }else{
    var obj_id      = $.trim(obj_id);
    var res         = $.trim(ssid_str).split("-");
    var setngsssid  = res[0];
  }

  if(setngsssid != ''){
    var setRowIndx  = hot3[obj_id].getSelected()[0];
    var tmpRowId    = hot3[obj_id].getDataAtCell(setRowIndx, 0);
    var setUrl      = '/ls/livespace/spreadsheet.rowview/'+setngsssid+'/'+tmpRowId+$app.queryString();
    $('#show-rowview-btn').attr('href',setUrl);
    $("#show-rowview-btn").trigger( "click" );
  }
};

 


</script>
                                                <div class="container-fluid  isLsSheet   d7975d38c745fea97f6855a8ad48544f">
                                                    <input type="hidden" name="isReport" id="isReport" value="1">
                                                    <span style="margin-top:-100px; position:absolute;" id="topmenubar-49-479-1-0-6_1"></span>
                                                    <div class="row-fluid">
                                                        <div class="noborder   col-md-12  ssarea
        ">
                                                            <div class="clearfix ssnamedetail ">
                                                                <div class="col-md-2 pl10">
                                                                    <input type="text" placeholder="Name" id="name-5b7275978b586b93007b2416-1-0-6_1" name="name" class="section spreadsheet form-control" value="Policy Illustrations">
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <input type="text" placeholder="Description" id="desc-5b7275978b586b93007b2416-1-0-6_1" name="desc" class="section spreadsheet form-control" value>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <span class="font_10 clr_gray ml5"></span>
                                                                    <span class="lock_cls font_10 clr_red ml5 "></span>
                                                                </div>
                                                                <a href="/ls/livespace/spreadsheet.columnsettings/49-479-1-0-6_1" data-width="500" id="slide-settings-btn" class="ajax hide"> <i title="Settings" class="icon-cog"></i></a>
                                                            </div>
                                                            <a id="show-rowhistory-btn" data-height="700px" data-width="85%" title="Row History" class="ajax hide"> <i title="RowHistory" class="icon-cog"></i></a>
                                                            <a id="show-rowview-btn" data-width="700" title="Row Detailed View" class="ajax hide"> <i title="Row Detailed View" class="icon-cog"></i></a>
                                                            <div class="clearfix">
                                                                <div class="box al clearfix">
                                                                    <div class="col-md-12 sstopmenu">
                                                                        <a class="hide">Policy...</a>
                                                                        <a class="showHideTblCtrl"><i class="im icon-ellipsis-v"></i></a>
                                                                        <a class="tip-top hide" title="Copy"></a>
                                                                        <a class="tip-top addrow">Add Row</a>
                                                                        <a class="tip-top refreshSSData">Refresh</a>
                                                                        <a class="tip-top wraptext" onclick="handsontableWrapTextToggle('49-479-1-0-6_1');"> Wrap Text</a>
                                                                        <a class="tip-top" onclick="handsontableRowHistory('49-479-1-0-6_1', '5b7275978b586b93007b2416-1-0-6_1');"> History</a>
                                                                        <a class="tip-top ssdownload" onclick="handsontableDownload('5b7275978b586b93007b2416-1-0-6_1','49-479-1-0-6_1');">Download</a>
                                                                        <input type="text" style="height: 23px;margin-bottom: 3px;text-indent: 5px; width: 150px;" placeholder="search" name="name" class="ss-text-search ml10 " value autocomplete="off">
                                                                        <a class="tip-top ss-text-search-el" title=" Search"> <i class="fa fa-search ss-text-search-btn" onclick="handsontableSearchAndSort('49-479-1-0-6_1', '5b7275978b586b93007b2416-1-0-6_1');"> </i></a>
                                                                        <select style="width:150px; height:23px; border-color: #ccc;" class="ss-sort-data noselect mt3 ml10" onclick="handsontableSearchAndSort('49-479-1-0-6_1', '5b7275978b586b93007b2416-1-0-6_1');">
                                                                            <option value>Sort By</option>
                                                                            <option value="SS_ROW_UPDATED_DT-asc">SS_ROW_UPDATED_DT - asc</option>
                                                                            <option value="SS_ROW_UPDATED_DT-desc">SS_ROW_UPDATED_DT - desc</option>
                                                                            <option value="791e2fa1b147eb5f5e28d5045841ef42-asc">UUID - asc</option>
                                                                            <option value="791e2fa1b147eb5f5e28d5045841ef42-desc" selected="selected">UUID - desc</option>
                                                                            <option value="656faff330364282e5cab8c4c04c0497-asc">CRID - asc</option>
                                                                            <option value="656faff330364282e5cab8c4c04c0497-desc">CRID - desc</option>
                                                                            <option value="d93e16255ba1489f7956e2ccbe9add88-asc">UID - asc</option>
                                                                            <option value="d93e16255ba1489f7956e2ccbe9add88-desc">UID - desc</option>
                                                                            <option value="06f7c2a468b901187b4eaa9cd48b3654-asc">Template - asc</option>
                                                                            <option value="06f7c2a468b901187b4eaa9cd48b3654-desc">Template - desc</option>
                                                                            <option value="6fd3dabe2893c5614b8771923ef29c13-asc">Document ID - asc</option>
                                                                            <option value="6fd3dabe2893c5614b8771923ef29c13-desc">Document ID - desc</option>
                                                                            <option value="f5082c266e77561730a29dabf9b35b04-asc">Policy ID - asc</option>
                                                                            <option value="f5082c266e77561730a29dabf9b35b04-desc">Policy ID - desc</option>
                                                                            <option value="11ae9145b76571d977cc54481b6aef97-asc">ClientID - asc</option>
                                                                            <option value="11ae9145b76571d977cc54481b6aef97-desc">ClientID - desc</option>
                                                                            <option value="3b842e5fcc67e9e8a34a7935d890f245-asc">ClientName - asc</option>
                                                                            <option value="3b842e5fcc67e9e8a34a7935d890f245-desc">ClientName - desc</option>
                                                                            <option value="2853f43d8ef5f3e8a67b5726468804a6-asc">ClientFullName - asc</option>
                                                                            <option value="2853f43d8ef5f3e8a67b5726468804a6-desc">ClientFullName - desc</option>
                                                                            <option value="4c72e4d9d93ce2387a45f5bb8a40e375-asc">Carrier ID - asc</option>
                                                                            <option value="4c72e4d9d93ce2387a45f5bb8a40e375-desc">Carrier ID - desc</option>
                                                                            <option value="3393fbb41507f3c2b119f77a061d77bb-asc">Contract Type - asc</option>
                                                                            <option value="3393fbb41507f3c2b119f77a061d77bb-desc">Contract Type - desc</option>
                                                                            <option value="3663a65f53b9ff1230dd7f0a03410335-asc">Primary Insured - asc</option>
                                                                            <option value="3663a65f53b9ff1230dd7f0a03410335-desc">Primary Insured - desc</option>
                                                                            <option value="10d41db1107e3ad07e8c5a81b4b2ebc0-asc">Insured ID - asc</option>
                                                                            <option value="10d41db1107e3ad07e8c5a81b4b2ebc0-desc">Insured ID - desc</option>
                                                                            <option value="166f7c9ba1461a73e7934a5bbf3d2fc2-asc">Secondary Insured - asc</option>
                                                                            <option value="166f7c9ba1461a73e7934a5bbf3d2fc2-desc">Secondary Insured - desc</option>
                                                                            <option value="7b413e7ea861c880140ee79e0d1a3a37-asc">Age - asc</option>
                                                                            <option value="7b413e7ea861c880140ee79e0d1a3a37-desc">Age - desc</option>
                                                                            <option value="6b12783971e27097c4b6b82ad0f42307-asc">Gender - asc</option>
                                                                            <option value="6b12783971e27097c4b6b82ad0f42307-desc">Gender - desc</option>
                                                                            <option value="98ec2d692cebc95f4d7b12610af36884-asc">Smoker - asc</option>
                                                                            <option value="98ec2d692cebc95f4d7b12610af36884-desc">Smoker - desc</option>
                                                                            <option value="2066b18fb101f60756de76a85fe0c7c2-asc">State - asc</option>
                                                                            <option value="2066b18fb101f60756de76a85fe0c7c2-desc">State - desc</option>
                                                                            <option value="13729866cd7c86aa7f3d6ec318b21f84-asc">UnderwriterClass - asc</option>
                                                                            <option value="13729866cd7c86aa7f3d6ec318b21f84-desc">UnderwriterClass - desc</option>
                                                                            <option value="76d85884ef5121d3f1ae595e0b4e020e-asc">Household - asc</option>
                                                                            <option value="76d85884ef5121d3f1ae595e0b4e020e-desc">Household - desc</option>
                                                                            <option value="c7c74e7ee2e9c5b9110ef0dc04c2d703-asc">Premium Mode - asc</option>
                                                                            <option value="c7c74e7ee2e9c5b9110ef0dc04c2d703-desc">Premium Mode - desc</option>
                                                                            <option value="76b32a9ff9f10e25ec849feb394dbf3c-asc">Premium Design - asc</option>
                                                                            <option value="76b32a9ff9f10e25ec849feb394dbf3c-desc">Premium Design - desc</option>
                                                                            <option value="5a07ecabe9458b010df6184fc83ce527-asc">Premium Duration - asc</option>
                                                                            <option value="5a07ecabe9458b010df6184fc83ce527-desc">Premium Duration - desc</option>
                                                                            <option value="20b3f226028fd68b41b1d60f34e54a8b-asc">Purpose - asc</option>
                                                                            <option value="20b3f226028fd68b41b1d60f34e54a8b-desc">Purpose - desc</option>
                                                                            <option value="21e64230adc555eb95aaedac4d0a7389-asc">Policy Date - asc</option>
                                                                            <option value="21e64230adc555eb95aaedac4d0a7389-desc">Policy Date - desc</option>
                                                                            <option value="e3a1a462ef7be320cc3a12b948df6151-asc">Carrier Name - asc</option>
                                                                            <option value="e3a1a462ef7be320cc3a12b948df6151-desc">Carrier Name - desc</option>
                                                                            <option value="dd539951ea98c887a90e52467d8d5773-asc">Owner Beneficiary Name - asc</option>
                                                                            <option value="dd539951ea98c887a90e52467d8d5773-desc">Owner Beneficiary Name - desc</option>
                                                                            <option value="f6451d3c1e1162f358ba6321c42033f9-asc">SM_InsuredName - asc</option>
                                                                            <option value="f6451d3c1e1162f358ba6321c42033f9-desc">SM_InsuredName - desc</option>
                                                                            <option value="0fd5ae46e8f4ce79c22a6d2d3450031d-asc">Risk Level - asc</option>
                                                                            <option value="0fd5ae46e8f4ce79c22a6d2d3450031d-desc">Risk Level - desc</option>
                                                                            <option value="07624ebbcd25928c5601a616b4b3ba7a-asc">PII - asc</option>
                                                                            <option value="07624ebbcd25928c5601a616b4b3ba7a-desc">PII - desc</option>
                                                                            <option value="afb65f60858af082c3329203d4cb4226-asc">PCI - asc</option>
                                                                            <option value="afb65f60858af082c3329203d4cb4226-desc">PCI - desc</option>
                                                                            <option value="a8acf61e92d99d06a6d67f61eab64ca1-asc">MemberFirm - asc</option>
                                                                            <option value="a8acf61e92d99d06a6d67f61eab64ca1-desc">MemberFirm - desc</option>
                                                                            <option value="b85df8c96731fabc27c7238c7a9fb6a5-asc">SourceFile - asc</option>
                                                                            <option value="b85df8c96731fabc27c7238c7a9fb6a5-desc">SourceFile - desc</option>
                                                                            <option value="5a06ca527c0979e813b85e1172c918f9-asc">VerifyStatus - asc</option>
                                                                            <option value="5a06ca527c0979e813b85e1172c918f9-desc">VerifyStatus - desc</option>
                                                                            <option value="36c0a938df8f10f24ad3ae12677c72b6-asc">VerifyButton - asc</option>
                                                                            <option value="36c0a938df8f10f24ad3ae12677c72b6-desc">VerifyButton - desc</option>
                                                                            <option value="0d634ef4f16357bdf70895fb22ca5dfa-asc">TemplateStatus - asc</option>
                                                                            <option value="0d634ef4f16357bdf70895fb22ca5dfa-desc">TemplateStatus - desc</option>
                                                                            <option value="905afcc64347a0c51c1f67139df35695-asc">AuditLog - asc</option>
                                                                            <option value="905afcc64347a0c51c1f67139df35695-desc">AuditLog - desc</option>
                                                                            <option value="c3506e994d0784d8d8be74e57e76fe94-asc">SelectBox - asc</option>
                                                                            <option value="c3506e994d0784d8d8be74e57e76fe94-desc">SelectBox - desc</option>
                                                                            <option value="6646ddc2f66a5c65f3f90c52dde11dba-asc">checkbox_selected - asc</option>
                                                                            <option value="6646ddc2f66a5c65f3f90c52dde11dba-desc">checkbox_selected - desc</option>
                                                                            <option value="e4b37926588b4653748784fe6e13249a-asc">LogReviewStatus - asc</option>
                                                                            <option value="e4b37926588b4653748784fe6e13249a-desc">LogReviewStatus - desc</option>
                                                                            <option value="fdf3aa4361b394def57539d557eefadf-asc">prev_scanned - asc</option>
                                                                            <option value="fdf3aa4361b394def57539d557eefadf-desc">prev_scanned - desc</option>
                                                                            <option value="bdc423fab2ff62caee83b2779bc9755e-asc">Initial Planned Premium - asc</option>
                                                                            <option value="bdc423fab2ff62caee83b2779bc9755e-desc">Initial Planned Premium - desc</option>
                                                                            <option value="042a6fb1ffdb2b211ccc76225a6698ba-asc">Total Premium Paid to Date - asc</option>
                                                                            <option value="042a6fb1ffdb2b211ccc76225a6698ba-desc">Total Premium Paid to Date - desc</option>
                                                                            <option value="d743babb514e22b0777aa4ea81bd709e-asc">Cash Surrender Value - asc</option>
                                                                            <option value="d743babb514e22b0777aa4ea81bd709e-desc">Cash Surrender Value - desc</option>
                                                                            <option value="b1811dd9381bffdf9136e7d537457e65-asc">DeathBenefit - asc</option>
                                                                            <option value="b1811dd9381bffdf9136e7d537457e65-desc">DeathBenefit - desc</option>
                                                                            <option value="bcc04db2756ed5e021dc3d68d8528f4d-asc">ScannedStatus - asc</option>
                                                                            <option value="bcc04db2756ed5e021dc3d68d8528f4d-desc">ScannedStatus - desc</option>
                                                                            <option value="5c7b68803c13118f9d8f26eabdc8ceb1-asc">DataSource - asc</option>
                                                                            <option value="5c7b68803c13118f9d8f26eabdc8ceb1-desc">DataSource - desc</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="_pan12" style="overflow:hidden">
                                                                <div class="handsontable dataTable  ssPaginateSheet " id="sheet-49-479-1-0-6_1" cnt-key="49-479" style="min-height:100px"></div>
                                                                <div class="clearfix  paginationContainer">
                                                                    <div class="paginationStatus flo mt10"> </div>
                                                                    <div class="ss-pagination  pagination fro mt10"> </div>
                                                                </div>
                                                                <a class="hide" id="btn-show-all-record">Show All Record </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="gs-w grid4" data-sizey="5" data-sizex="12" data-col="1" data-row="11" data-autoheight="false">
                                        <div class="gridster-box">
                                            <div class="tName ">
                                                <div class="dashboard-element-name"> Consolidated Reports </div>
                                                <a tittle="Add Record" class=" addRecordSSForm"> <span>+</span> Add </a>
                                                <span class="icon_  bor_no justExcel grid4">
                                                    <a class="icon-resize-full fro mr10 tip" href="#image-625" title="Resize.Window"></a>
                                                    <a id="49-625" class="export-ex icon-excel btn fro mt2 mr20 tip" title="Export as Excel"></a>
                                                </span>
                                            </div>
                                            <div data-sizey="5" class="objectContent" data-id="49-625">
                                                <div id="b5defc830b0bc272622b4102dc8ded79" class="controller">
                                                    <div id="6cd406e32ec9e944009237363fc89908" class="widget-box  ">
                                                        <div class="widget-title    ssform-enabled panel_expandscreen  sstag-enabled">
                                                            <span class="icon">
                                                                <a id="e597fae890acf0922b252ae5402c64d3" title="Add Record " href="/analytics/form.preview/5c0522108f7c44710c7b23c6/r-625-49?_ls=188-2" class="vwidget-abtn flo pl5 pr5 mr3 btn btn-small icon-large chk_button_act tip circleHoverItem-after plus ssform viz_viz_viz_bton hide ">
                                                                    <span class="fa fa-plus ssform viz_viz_viz_bton hide"></span> Record
                                                                </a>
                                                            </span>
                                                        </div>
                                                        <div class="widget-content nopadding _ssform-enabled panel_expandscreen  sstag-enabled">
                                                            <table class="in  table table-hover data-table  dataTable ssform-enabled panel_expandscreen  sstag-enabled dTable">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="col c-0 f o"></th>
                                                                        <th class="col c-1 e">Template</th>
                                                                        <th class="col c-2 o">Beneficiary</th>
                                                                        <th class="col c-3 e">Created On</th>
                                                                        <th class="col c-4 l o">Status</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                                <form name="export_form" id="export_form" action="/ls/liveapps.export/?_ls=188-2">
                                    <input type="hidden" id="content_id" name="content_id">
                                    <input type="hidden" id="json" name="json">
                                    <input type="hidden" id="pGroupBy" name="pGroupBy">
                                    <input type="hidden" id="pTagKey" name="pTagKey" value>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane  " id="tab2">
                    <div class=" ">
                        <div class="row-fluid  clearfix ">
                            <div class="gridster">
                                <ul>
                                    <li class="gs-w grid4" data-sizey="4" data-sizex="12" data-col="1" data-row="1" data-autoheight="false">
                                        <div class="gridster-box">
                                            <div class="tName ">
                                                <div class="dashboard-element-name"> PolicySampleGrid_test </div>
                                                <a tittle="Add Record" class=" addRecordSSForm"> <span>+</span> Add </a>
                                                <span class="icon_  bor_no justExcel grid4">
                                                    <a class="icon-resize-full fro mr10 tip" href="#image-539" title="Resize.Window"></a>
                                                    <a id="49-539" class="export-ex icon-excel btn fro mt2 mr20 tip" title="Export as Excel"></a>
                                                </span>
                                            </div>
                                            <div data-sizey="4" class="objectContent" data-id="49-539">
                                                <div id="99c6b8067dd35edb520dbbfdab2cb6ee" class="controller">
                                                    <div id="10492bb22c45cc771be5006d31ab1f90" class="widget-box  ">
                                                        <div class="widget-title    ssform-enabled panel_expandscreen ">
                                                            <span class="icon">
                                                                <a id="151a586dbb69a7e3ea09cc92d6475b53" title="Add Record " href="/analytics/form.preview/5bee9ae48f7c4454087b23cc/r-539-49?_ls=188-2" class="vwidget-abtn flo pl5 pr5 mr3 btn btn-small icon-large chk_button_act tip circleHoverItem-after plus ssform viz_viz_viz_bton hide ">
                                                                    <span class="fa fa-plus ssform viz_viz_viz_bton hide"></span> Record
                                                                </a>
                                                            </span>
                                                        </div>
                                                        <div class="widget-content nopadding _ssform-enabled panel_expandscreen ">
                                                            <table class="in  table table-hover data-table  dataTable ssform-enabled panel_expandscreen  dTable">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="col c-0 f e"></th>
                                                                        <th class="col c-1 o">UUID</th>
                                                                        <th class="col c-2 e">Primary Insured</th>
                                                                        <th class="col c-3 o">Document ID</th>
                                                                        <th class="col c-4 l e">Carrier Name</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                                <form name="export_form" id="export_form" action="/ls/liveapps.export/?_ls=188-2">
                                    <input type="hidden" id="content_id" name="content_id">
                                    <input type="hidden" id="json" name="json">
                                    <input type="hidden" id="pGroupBy" name="pGroupBy">
                                    <input type="hidden" id="pTagKey" name="pTagKey" value>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane  " id="tab3">
                    <div class=" ">
                        <div class="row-fluid  clearfix ">
                            <div class="gridster">
                                <ul>
                                    <li class="gs-w chart2 sub_pie" data-sizey="4" data-sizex="6" data-col="1" data-row="1" data-autoheight="false">
                                        <div class="gridster-box">
                                            <div class="tName ">
                                                <div class="dashboard-element-name"> Cash Value </div>
                                                <span class="icon_  bor_no justExcel chart2 chartypedpie">
                                                    <a class="icon-resize-full fro mr10 tip" href="#image-655" title="Resize.Window"></a>
                                                </span>
                                            </div>
                                            <div data-sizey="4" class="objectContent" data-id="49-655">
                                                <div id="dbe8b2e7e7d8ebdd8387833d656420a1" class="controller">
                                                    <i class="fa fa-spinner font_40 i-green  fa-spin"></i>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="gs-w chart2 sub_column" data-sizey="4" data-sizex="6" data-col="7" data-row="1" data-autoheight="false">
                                        <div class="gridster-box">
                                            <div class="tName ">
                                                <div class="dashboard-element-name"> Death Benefit Chart </div>
                                                <span class="icon_  bor_no justExcel chart2 chartypedcolumn">
                                                    <a class="icon-resize-full fro mr10 tip" href="#image-656" title="Resize.Window"></a>
                                                </span>
                                            </div>
                                            <div data-sizey="4" class="objectContent" data-id="49-656">
                                                <div id="95a22abfe2b469e16a861c35a38b6274" class="controller">
                                                    <i class="fa fa-spinner font_40 i-green  fa-spin"></i>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                                <form name="export_form" id="export_form" action="/ls/liveapps.export/?_ls=188-2">
                                    <input type="hidden" id="content_id" name="content_id">
                                    <input type="hidden" id="json" name="json">
                                    <input type="hidden" id="pGroupBy" name="pGroupBy">
                                    <input type="hidden" id="pTagKey" name="pTagKey" value>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane  " id="tab4">
                    <div class=" ">
                        <div class="row-fluid  clearfix ">
                            <div class="gridster">
                                <ul>
                                    <li class="gs-w htmlcard" data-sizey="7" data-sizex="12" data-col="1" data-row="1" data-autoheight="false">
                                        <div class="gridster-box">
                                            <div class="tName ">
                                                <div class="dashboard-element-name"> PolicyDetails </div>
                                                <span class="icon_  bor_no justExcel htmlcard">
                                                    <a class="icon-resize-full fro mr10 tip" href="#image-855" title="Resize.Window"></a>
                                                </span>
                                            </div>
                                            <div data-sizey="7" class="objectContent" data-id="49-855">
                                                <div id="973a3baafa4cd7386b2124bca32bfed8" class="controller">
                                                    <div class="card color-green border-dotted border1px bg-white app-list-card card-1" data-mode="new">
                                                        <div class="content-wrapper">
                                                            <h1>Test code1</h1>
                                                            <h1>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</h1>
                                                        </div>
                                                        <div class="pagebreak"></div>
                                                        <div class="content-wrapper">
                                                            <h1>Test code2</h1>
                                                            <h1>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</h1>
                                                            <h1>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</h1>
                                                        </div>
                                                        <div class="pagebreak"></div>
                                                        <div class="content-wrapper">
                                                            <h1>Test code3</h1>
                                                            <h1>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</h1>
                                                            <h1>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</h1>
                                                            <h1>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</h1>
                                                        </div>
                                                        <div class="pagebreak"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                                <form name="export_form" id="export_form" action="/ls/liveapps.export/?_ls=188-2">
                                    <input type="hidden" id="content_id" name="content_id">
                                    <input type="hidden" id="json" name="json">
                                    <input type="hidden" id="pGroupBy" name="pGroupBy">
                                    <input type="hidden" id="pTagKey" name="pTagKey" value>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <script>
                $('body').on('click', '#lapps_title', function(){
      
      $(this).get(0).select();
    })

var tabObjects = { }
  tabObjects['tab1'] = [
                                              {
      "size_y":"5",
      "size_x":"12",
      "col":"1",
      "row":"1",
      "fid": "1293#188-476",
      "realTime":false,
      "tflag": 1,
       "autoheight":false
    },

                                              {
      "size_y":"5",
      "size_x":"12",
      "col":"1",
      "row":"6",
      "fid": "1019#188-479",
      "realTime":false,
      "tflag": 1,
       "autoheight":false
    },

                                              {
      "size_y":"5",
      "size_x":"12",
      "col":"1",
      "row":"11",
      "fid": "1056#188-625",
      "realTime":false,
      "tflag": 1,
       "autoheight":false
    },

    ]
  tabObjects['tab2'] = [
                                              {
      "size_y":"4",
      "size_x":"12",
      "col":"1",
      "row":"1",
      "fid": "1556#188-539",
      "realTime":false,
      "tflag": 1,
       "autoheight":false
    },

    ]
  tabObjects['tab3'] = [
                                              {
      "size_y":"4",
      "size_x":"6",
      "col":"1",
      "row":"1",
      "fid": "-655",
      "realTime":false,
      "tflag": 1,
       "autoheight":false
    },

                                              {
      "size_y":"4",
      "size_x":"6",
      "col":"7",
      "row":"1",
      "fid": "1710#188-656",
      "realTime":false,
      "tflag": 1,
       "autoheight":false
    },

    ]
  tabObjects['tab4'] = [
                                              {
      "size_y":"7",
      "size_x":"12",
      "col":"1",
      "row":"1",
      "fid": "-855",
      "realTime":false,
      "tflag": 1,
       "autoheight":false
    },

    ]
gridster = { };
$(document).ready(function () {
  filtrCountPosSet();

  function hideGridsterElement(gridster,classname){
    var elements = $(".gs-w."+classname);
    elements.each(function (index, value) { 
       gridster.remove_widget( $(this) );
    }); 
  } 

      

            gridster['tab1'] = $(".tab-pane#tab1 ul:not('.arrangeDashBoard')").gridster(    {
                widget_base_dimensions: ["auto", 78],
                namespace: '.tab-pane#tab1',
                autogenerate_stylesheet: true,
                max_cols: 12,
                max_rows: 40,
                shift_widgets_up: false,
                widget_selector:'li.gs-w',
                avoid_overlapped_widgets: true,
                widget_margins: [15, 25],
                draggable: {
                  handle: '.gridsterAddAction'
                }

                            } ).data('gridster').disable();
                    new $app.do({  time:400, action:function(){
                      hideGridsterElement(gridster['tab1'],"inactive");
                      $('.tab-pane#tab1 .dataTables_scrollBody').each(function(){
                          var ph = $(this).closest('.objectContent').height();
                          var _tHead =  $(this).parent().find('.dataTables_scrollHead').height();
                          $(this).height(ph - 52 - _tHead).css({    'overflow-x': 'auto',
                                'overflow-y': 'auto'});
                      });
                    $('.tab-pane#tab1 .gs-w.sub_stacked').each(function(){
                        el = $(this);
                        var data  = gridster['tab1'].serialize(el);
                        gridster['tab1'].resize_widget(el, data[0].size_x, 1,false );
                        $(window).trigger('resize');
                    });


              


                }});

                $('.tab-pane#tab1 .gs-w.datalist[data-autoheight="true"] ').each(function(){
                        el = $(this);
                        var data  = gridster['tab1'].serialize(el);
                        var dataY =  Math.floor( (window.innerHeight - 150 ) / 98 );
                        gridster['tab1'].resize_widget(el, data[0].size_x, dataY,false );
                        el.find( '.tileListViewsUl').attr( 'data-sizey-list',  dataY );
                        el.find( '.objectContent').attr( 'data-sizey',  dataY );
                        $(window).trigger('resize');
                    });


              
     

          $('[data-tabcount="2"]').one('shown.bs.tab',function(){
    gridster['tab2'] = $(".tab-pane#tab2 ul:not('.arrangeDashBoard')").gridster(    {
            widget_base_dimensions: ["auto", 78],
              namespace: '.tab-pane#tab2',
            autogenerate_stylesheet: true,
            max_cols: 12,
            max_rows: 40,
            shift_widgets_up: false,
            widget_selector:'li.gs-w',
            avoid_overlapped_widgets: true,
            widget_margins: [15, 25]
                        ,disable:true
                                  } ).data('gridster').disable();
                          new $app.do({  time: 100, action:function(){
                      hideGridsterElement(gridster['tab2'],"inactive");
                      $('.tab-pane#tab2 .dataTables_scrollBody').each(function(){
                                var ph = $(this).closest('.objectContent').height();
                                var _tHead =  $(this).parent().find('.dataTables_scrollHead').height();
                                $(this).height(ph - 67 - _tHead).css({    'overflow-x': 'auto',
                                'overflow-y': 'auto'});
                              });
                    $('.tab-pane#tab2 .gs-w.sub_stacked').each(function(){
                        el = $(this);
                        var data  = gridster['tab2'].serialize(el);
                        gridster['tab2'].resize_widget(el, data[0].size_x, 1,false );
                        $(window).trigger('resize');
                    });
                }});

                $('.tab-pane#tab2 .gs-w.datalist[data-autoheight="true"] ').each(function(){
                        el = $(this);
                        var data  = gridster['tab2'].serialize(el);
                        var dataY =  Math.floor( (window.innerHeight - 150 ) / 98 );
                        gridster['tab2'].resize_widget(el, data[0].size_x, dataY,false );
                        el.find( '.tileListViewsUl').attr( 'data-sizey-list',  dataY );
                        el.find( '.objectContent').attr( 'data-sizey',  dataY );
                      /*  $(window).trigger('resize'); */
                    });
                    
              
  })
      

          $('[data-tabcount="3"]').one('shown.bs.tab',function(){
    gridster['tab3'] = $(".tab-pane#tab3 ul:not('.arrangeDashBoard')").gridster(    {
            widget_base_dimensions: ["auto", 78],
              namespace: '.tab-pane#tab3',
            autogenerate_stylesheet: true,
            max_cols: 12,
            max_rows: 40,
            shift_widgets_up: false,
            widget_selector:'li.gs-w',
            avoid_overlapped_widgets: true,
            widget_margins: [15, 25]
                        ,disable:true
                                  } ).data('gridster').disable();
                          new $app.do({  time: 100, action:function(){
                      hideGridsterElement(gridster['tab3'],"inactive");
                      $('.tab-pane#tab3 .dataTables_scrollBody').each(function(){
                                var ph = $(this).closest('.objectContent').height();
                                var _tHead =  $(this).parent().find('.dataTables_scrollHead').height();
                                $(this).height(ph - 67 - _tHead).css({    'overflow-x': 'auto',
                                'overflow-y': 'auto'});
                              });
                    $('.tab-pane#tab3 .gs-w.sub_stacked').each(function(){
                        el = $(this);
                        var data  = gridster['tab3'].serialize(el);
                        gridster['tab3'].resize_widget(el, data[0].size_x, 1,false );
                        $(window).trigger('resize');
                    });
                }});

                $('.tab-pane#tab3 .gs-w.datalist[data-autoheight="true"] ').each(function(){
                        el = $(this);
                        var data  = gridster['tab3'].serialize(el);
                        var dataY =  Math.floor( (window.innerHeight - 150 ) / 98 );
                        gridster['tab3'].resize_widget(el, data[0].size_x, dataY,false );
                        el.find( '.tileListViewsUl').attr( 'data-sizey-list',  dataY );
                        el.find( '.objectContent').attr( 'data-sizey',  dataY );
                      /*  $(window).trigger('resize'); */
                    });
                    
              
  })
      

          $('[data-tabcount="4"]').one('shown.bs.tab',function(){
    gridster['tab4'] = $(".tab-pane#tab4 ul:not('.arrangeDashBoard')").gridster(    {
            widget_base_dimensions: ["auto", 78],
              namespace: '.tab-pane#tab4',
            autogenerate_stylesheet: true,
            max_cols: 12,
            max_rows: 40,
            shift_widgets_up: false,
            widget_selector:'li.gs-w',
            avoid_overlapped_widgets: true,
            widget_margins: [15, 25]
                        ,disable:true
                                  } ).data('gridster').disable();
                          new $app.do({  time: 100, action:function(){
                      hideGridsterElement(gridster['tab4'],"inactive");
                      $('.tab-pane#tab4 .dataTables_scrollBody').each(function(){
                                var ph = $(this).closest('.objectContent').height();
                                var _tHead =  $(this).parent().find('.dataTables_scrollHead').height();
                                $(this).height(ph - 67 - _tHead).css({    'overflow-x': 'auto',
                                'overflow-y': 'auto'});
                              });
                    $('.tab-pane#tab4 .gs-w.sub_stacked').each(function(){
                        el = $(this);
                        var data  = gridster['tab4'].serialize(el);
                        gridster['tab4'].resize_widget(el, data[0].size_x, 1,false );
                        $(window).trigger('resize');
                    });
                }});

                $('.tab-pane#tab4 .gs-w.datalist[data-autoheight="true"] ').each(function(){
                        el = $(this);
                        var data  = gridster['tab4'].serialize(el);
                        var dataY =  Math.floor( (window.innerHeight - 150 ) / 98 );
                        gridster['tab4'].resize_widget(el, data[0].size_x, dataY,false );
                        el.find( '.tileListViewsUl').attr( 'data-sizey-list',  dataY );
                        el.find( '.objectContent').attr( 'data-sizey',  dataY );
                      /*  $(window).trigger('resize'); */
                    });
                    
              
  })
      

    
    });
/* 
   // Select the node that will be observed for mutations
var targetNode = document.getElementById('arrangeDashBoard');

// Options for the observer (which mutations to observe)
var config = { attributes: true, childList: false, subtree: false };

// Callback function to execute when mutations are observed
var callback = function(mutationsList, observer, ev) {
  console.trace(ev);
    for(var mutation of mutationsList) {
        if (mutation.type == 'childList') {
            console.log('A child node has been added or removed.');
        }
        else if (mutation.type == 'attributes') {
            console.log('The ' + mutation.attributeName + ' attribute was modified.' , mutation , observer );
        }
    }
};

// Create an observer instance linked to the callback function
var observer = new MutationObserver(callback);

// Start observing the target node for configured mutations
observer.observe(targetNode, config);
*/
 
</script>
            <ul class="code-scratch-cr hide"></ul>
        </div><input type="hidden" name="section" class="section" value="leftLiveappsView"><input type="hidden" name="filter_url" id="filter_url" value="UUID::2546"><input type="hidden" name="appsId" id="appsId" value="49"><input type="hidden" name="mode" id="mode" value="dashboard">
        <style> .isDash .chartLabelBlock { font-size:18px; }.isDash .chartLabel { margin-top:2px !important; }header {
    display: none;
}

section#ls {
    padding: 49px 10px 2px 42px;
}
.justExcel, .dataTables_filter, .filtrCountPoscls {
   display: none !important;
}
.sstopmenu{ opacity:0}
</style>
        <script>
            var hot3 = [];
var dtl =[];
var vizCharts = [],gridUplodtag={};
</script>
    </section>
    <aside id="rightPanel" class="rightPanel">
        <div id="rigtPanelWrap"><a class="expandRightBtn blockIconButton"> <span class="ex">Expand</span><i class="ex fa fa-chevron-left"></i> <span class="co">Collapse</span><i class="co fa fa-chevron-right"></i> </a><a class="closePanel blockIconButton"><span>Close</span><i class="fa fa-times"></i></a>
            <div id="rightTab">
                <div class="pull-right pl0 rightPan pr0  col-md-12 " id="rightPan">
                    <!--Tabs List-->
                    <div class="rightPanelTab">
                        <ul class="nav nav-tabs mb0" id="rightTabul">
                            <li class="  tabfiles" data-activeright="files"><a class="tabItem" data-tabcount="files" href="#homefiles" data-toggle="tab"> files </a></li>
                            <li class="  tabdash" data-activeright="dash"><a class="tabItem" data-tabcount="dash" href="#homedash" data-toggle="tab"> dashboard </a></li>
                            <li class="active  tabmessages" data-activeright="messages"><a class="tabItem" data-tabcount="messages" href="#homemessages" data-toggle="tab"> messages </a></li>
                            <li class="  tabstatic" data-activeright="static"><a class="tabItem" data-tabcount="static" href="#homestatic" data-toggle="tab">Static</a></li>
                        </ul>
                        <!--Content List-->
                        <div class="tab-content">
                            <div class="tab-pane clearfix _rightpaneltab " id="homefiles">
                                <div class="rightFilter"> </div>
                                <div class="right-content-files">
                                    <div class="mt10">Please type a keyword to search...</div>
                                </div>
                            </div>
                            <div class="tab-pane clearfix _rightpaneltab " id="homedash">
                                <div class="rightFilter"> </div>
                                <div class="right-content-dash">
                                    <div class="mt10">Please type a keyword to search...</div>
                                </div>
                            </div>
                            <div class="tab-pane clearfix _rightpaneltab active" id="homemessages">
                                <div class="rightFilter"> </div>
                                <div class="right-content-messages">
                                    <script>var lastState = 2;</script>
                                    <!--gSearchResultAjax start-->
                                    <div class="SerchBargray   clearfix"><span class="SelectLsDr" title="Choose App to broadcast">M-Financial Demo Messages</span></div>
                                    <div class="gSearchResultAjax col-md-12 pl0 pr0">
                                        <div class="gSearchResultAjaxInner">
                                            <div class="files_search tab-pane"></div>
                                            <div class="report_search tab-pane"></div>
                                            <div class="messages_search tab-pane mb0" style="margin-bottom:0px; padding-bottom:0px">
                                                <div id="broad_cast_div" style="position:fixed;bottom:1px;z-index:300" class="noCurve mt10">
                                                    <form id="broad_cast_form" action method="post" enctype="multipart/form-data">
                                                        <div class="clear"></div>
                                                        <div class="broadcast ml5 mr5" style="position:relative; margin-bottom:-1px;"><textarea class="elm1  add_broadcast_fld" style cols="500" rows name="bcastmsg" id="add_broadcast_fld" placeholder="Type Your Message"></textarea>
                                                            <div class="height_32   fro absolute attachBtnBrodcast" id="attach_click"><i class="fa fa-paperclip"> </i></div>
                                                        </div>
                                                        <div class="clear"></div>
                                                        <div id="common_div" class="fancy_patch clearfix relative">
                                                            <div id="add_attach_box" class="add_attach_box" style="position:relative !important"><input type="file" name="attach_file[]" id="attach_file" multiple style="display:none;"><input type="hidden" name="element_id" id="element_id" value="1"><a class="addattach_remove" id="addattach_remove"><i class="fa fa-times"> </i></a>
                                                                <div class="mb5 mt5 ml5">
                                                                    <div class="filemessageUploadWrap"><span id="progressPercentage" style="position:absolute;bottom:0;right:25px"></span>
                                                                        <ul id="files" class="ml1 clearfix pl0 mb0">No Files Selected</ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div id="tag_attach_box" class="add_attach_box " style="position:relative !important"><input type="hidden" name="tags" id value="1"><a class="fro mt5 mr5" id="tag_attach_remove"><i class="fa fa-times"> </i></a>
                                                                <div class="mb5 mt5 ml5 bcast_tagName " id="bcast_tagName"><a><i class="fa fa-file-excel-o font_15"> </i></a>&nbsp;<span class="taglist  font_14 " style="color: #0E943D;"></span><span class=" font_11  fro mr10" style="color: #999;display:none"> Spreadsheet Tag </span></div>
                                                            </div>
                                                        </div>
                                                        <div id="bcast" class="border_lef height_32 pr10 flo pl10"><input type="hidden" name="dot_ch" id="dot_index" value><input type="hidden" name="dot_ch" id="at_index" value></div>
                                                    </form>
                                                </div>
                                                <script>
                                                $('#add_broadcast_fld').focus();
                                                </script>
                                                <div class=" text-center font_15 muted"><i class="im icon-speech" style="font-size:3em;margin-top: 70px;margin-bottom: 20px;color:#888;"></i> <br>No message found in M-Financial Demo </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--gSearchResultAjax end-->
                                </div>
                            </div>
                            <div class="tab-pane clearfix _rightpaneltab" id="homestatic">
                                <div class="right-content-static"> </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </aside>
    <script class="js" type="text/javascript" src="js/jquery-ui.min.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.validate.min.js"></script>
    <script class="js" type="text/javascript" src="js/additional-methods.min.js"></script>
    <script class="js" type="text/javascript" src="js/vizru-validation-methods.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.scrollto.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.cookie.js"></script>
    <script class="js" type="text/javascript" src="js/cms.js"></script>
    <script class="js" type="text/javascript" src="js/handsonatable.full.js"></script>
    <script class="js" type="text/javascript" src="js/md5.js"></script>
    <script class="js" type="text/javascript" src="js/lodash.js"></script>
    <script class="js" type="text/javascript" src="js/underscore.string.js"></script>
    <script class="js" type="text/javascript" src="js/numeral.js"></script>
    <script class="js" type="text/javascript" src="js/numeric.js"></script>
    <script class="js" type="text/javascript" src="js/md5_1.js"></script>
    <script class="js" type="text/javascript" src="js/jstat.js"></script>
    <script class="js" type="text/javascript" src="js/formula.js"></script>
    <script class="js" type="text/javascript" src="js/parser.js"></script>
    <script class="js" type="text/javascript" src="js/ruleJS.js"></script>
    <script class="js" type="text/javascript" src="js/handsontable.formula.js"></script>
    <script class="js" type="text/javascript" src="js/plupload.full.min.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.plupload.queue.min.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.dataTables.min.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.multiselect.custom.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.multiselect.filter.js"></script>
    <script class="js" type="text/javascript" src="js/highcharts.js"></script>
    <script class="js" type="text/javascript" src="js/tribute.min.js"></script>
    <script class="js" type="text/javascript" src="js/file_script.js"></script>
    <script class="js" type="text/javascript" src="js/dashBoardChat.js"></script>
    <script class="js" type="text/javascript" src="js/favorite.js"></script>
    <script class="js" type="text/javascript" src="js/file-drag.js"></script>
    <script class="js" type="text/javascript" src="js/react.production.min.js"></script>
    <script class="js" type="text/javascript" src="js/react-dom.production.min.js"></script>
    <script class="js" type="text/javascript" src="js/theme.js"></script>
    <script class="js" type="text/javascript" src="js/bootstrap.min.js"></script>
    <script class="js" type="text/javascript" src="js/bootstrap3-typeahead.min.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.bootstrap.wizard.js"></script>
    <script class="js" type="text/javascript" src="js/bootstrap-switch.js"></script>
    <script class="js" type="text/javascript" src="js/select2.full.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.gridster.min.js"></script>
    <script class="js" type="text/javascript" src="js/broadcast.js"></script>
    <script class="js" type="text/javascript" src="js/unicorn.js"></script>
    <script class="js" type="text/javascript" src="js/rightbar.js"></script>
    <script class="js" type="text/javascript" src="js/perfect-scrollbar.jquery.min.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.elastic.source.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.fancybox.pack.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.fileupload.js"></script>
    <script class="js" type="text/javascript" src="js/masonryv4.1.1.js"></script>
    <script class="js" type="text/javascript" src="js/main.js"></script>
    <script class="js" type="text/javascript" src="js/plugins.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.knob.js"></script>
    <script class="js" type="text/javascript" src="js/token-input.js"></script>
    <script class="js" type="text/javascript" src="js/moment.min.js"></script>
    <script class="js" type="text/javascript" src="js/daterangepicker.js"></script>
    <script class="js" type="text/javascript" src="js/timepicker.js"></script>
    <script class="js" type="text/javascript" src="js/vizru-custom.js"></script>
    <script class="js" type="text/javascript" src="js/loading.js"></script>
    <script class="js" type="text/javascript" src="js/gridster.min.js"></script>
    <script class="js" type="text/javascript" src="js/dataList.js"></script>
    <script class="js" type="text/javascript" src="js/datalist_react.min.js"></script>
    <script class="js" type="text/javascript" src="js/underscore.js"></script>
    <script class="js" type="text/javascript" src="js/mediaelement-and-player.min.js"></script>
    <script class="js" type="text/javascript" src="js/filtersection.js"></script>
    <script class="js" type="text/javascript" src="js/data.js"></script>
    <script class="js" type="text/javascript" src="js/export.js"></script>
    <script class="js" type="text/javascript" src="js/dmupload.js"></script>
    <script class="js" type="text/javascript" src="js/ckeditor.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.js"></script>
    <script class="js" type="text/javascript" src="js/spreadsheet.js"></script>
    <script class="js" type="text/javascript" src="js/list.js"></script>
    <script class="js" type="text/javascript" src="js/jsonTree.js"></script>
    <script class="js" type="text/javascript" src="js/split-pane.js"></script>
    <script class="js" type="text/javascript" src="js/grid.js"></script>
    <script class="js" type="text/javascript" src="js/ssgrid.js"></script>
    <script class="js" type="text/javascript" src="js/html.js"></script>
    <script class="js" type="text/javascript" src="js/bootstrap-tour.min.js"></script>
    <script class="js" type="text/javascript" src="js/static-tour.js"></script>
    <script class="js" type="text/javascript" src="js/tour.js"></script>
    <script class="js" type="text/javascript" src="js/a-file-form.js"></script>
    <script class="js" type="text/javascript" src="js/dashboard.js"></script>
    <script class="js" type="text/javascript" src="js/goldenlayout.js"></script>
    <script class="js" type="text/javascript" src="js/bootstrap-datetimepicker.min.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.jsonview.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.jsonview.data.js"></script>
    <script class="js" type="text/javascript" src="js/tagging.js"></script>
    <script class="js" type="text/javascript" src="js/socket.io.min.js"></script>
    <script class="js" type="text/javascript" src="js/axios.min.js"></script>
    <script class="js" type="text/javascript" src="js/form_react_func.min.js"></script>
    <script class="js" type="text/javascript" src="js/ssform.js"></script>
    <script class="js" type="text/javascript" src="js/jquery.form.js"></script>
    <script class="js" type="text/javascript" src="js/app.js"></script>
    <script class="js" type="text/javascript" src="js/password_change.js"></script>
    <script class="js" type="text/javascript">
    jQuery.extend($app, { "user": { "id": "188", "name": "lucas", "email": "lucas@vizru.com" } });
    jQuery(function($) {
        (function($me) {
            try {
                $.get('/ls/livespace/custom.js/2')
                    .done(function(data) {
                        eval(data.Result);
                    });
                $.get('/ls/liveapps.liveappleftmenu/49-188-2/UUID/2546' + $app.queryString())
                    .done(function(data) {
                        $('#liveAppLeftMenu:nth-child(1)').append(data.Body);
                        eval(data.Refs['js-code']);
                        doUpadate_();
                        $('.LappLoder').fadeOut();

                    });
                $.get('/ls/liveapps.primaryfilter/49-188-2/UUID/2546' + $app.queryString())
                    .done(function(data) {
                        $('.filterPrimary').append(data.Body);
                        eval(data.Refs['js-code']);
                        doUpadate_();
                        $('.LappLoder').fadeOut();

                    });
                $(".widget-content p").addClass("webdoc");
                jQuery.extend($app, { "activeLs": { "name": "M-Financial Demo", "lid": "2" } });
                (function($me) {
                    try {
                        $me.each(sys_controllers_ls_favorite);
                        (function($me) {
                            try {
                                $me.data('json-conf', { "actions": { "srtdash": { "Hash": "5cb811d7190875952fd2ae4e8925daac", "Name": "srtdash", "Title": "Set As Landing", "IconClass": "dashboard   ", "Url": "\/sys\/ui\/widgets\/grids\/datatable.an\/srtdash\/a%3A2%3A%7Bi%3A0%3Bs%3A49%3A%22Sys%5CControllers%5CLs%5CLiveapps%5CFilter%5CCriteria%5CList_%22%3Bi%3A1%3Bs%3A12%3A%22doListAction%22%3B%7D", "Link": false, "Confirm": "", "Select": [0, 0] }, "delete": { "Hash": "688af693653cfb873539503847fa6fea", "Name": "delete", "Title": "Delete", "IconClass": "trash", "Url": "\/sys\/ui\/widgets\/grids\/datatable.an\/delete\/a%3A2%3A%7Bi%3A0%3Bs%3A49%3A%22Sys%5CControllers%5CLs%5CLiveapps%5CFilter%5CCriteria%5CList_%22%3Bi%3A1%3Bs%3A12%3A%22doListAction%22%3B%7D", "Link": false, "Confirm": "", "Select": [0, 0] } }, "variables": "a:3:{s:7:\"user-id\";s:3:\"188\";s:12:\"livespace-id\";s:1:\"2\";s:12:\"dashboard-id\";s:6:\"49-188\";}" }).each(sys_ui_widgets_grids_grid);
                                $me.find('.dTable.data-table').dataTable($.extend({
                                    "aoColumns": [{ "mData": null, "bSearchable": false, "bSortable": false, "sWidth": "20px" }, { "sName": 0, "mData": "_0" }, { "sName": 1, "mData": "_1" }],
                                    "bJQueryUI": true,
                                    "bSortClasses": false,
                                    "bStateSave": false,
                                    "sScrollX": "",
                                    "sScrollY": "",
                                    "bServerSide": true,
                                    "bProcessing": true,
                                    "bInfo": true,
                                    "bDeferRender": true,
                                    "bAutoWidth": false,
                                    "bColDataWidth": false,
                                    "bcolumnGroup": false,
                                    "bcolumnSort": false,
                                    "bColumnGroupDefault": null,
                                    "bDatalistOrigin": "default",
                                    "bFilter": true,
                                    "bPaginate": true,
                                    "aaSorting": [],
                                    "dataListActionBtns": true,
                                    "sDom": "lfrtip",
                                    "bLengthChange": true,
                                    "iDisplayLength": 25,
                                    "sCookiePrefix": "vui-grid-",
                                    "sPaginationType": "full",
                                    "sServerMethod": "POST",
                                    "sAjaxSource": "\/sys\/ui\/widgets\/grids\/datatable.cb\/a%3A2%3A%7Bi%3A0%3Bs%3A49%3A%22Sys%5CControllers%5CLs%5CLiveapps%5CFilter%5CCriteria%5CList_%22%3Bi%3A1%3Bs%3A19%3A%22gridAllFilterFields%22%3B%7D",
                                    "oLanguage": { "sInfo": "Showing _START_ to _END_ of _TOTAL_ records.", "sInfoEmpty": "No entries to show", "sZeroRecords": "No records to display.", "sLoadingRecords": "Please wait - loading...", "sSearch": "" },
                                    "aLengthMenu": [
                                        [25, 50, 100, -1],
                                        [25, 50, 100, "All"]
                                    ]
                                }, {
                                    'fnServerData': function(sSource, aoData, fnCallback, oSettings) {
                                        aoData.push({ 'name': 'variables', 'value': "a:3:{s:7:\"user-id\";s:3:\"188\";s:12:\"livespace-id\";s:1:\"2\";s:12:\"dashboard-id\";s:6:\"49-188\";}" });
                                        oSettings.jqXHR = $.ajax({
                                            'dataType': 'json',
                                            'type': 'POST',
                                            'url': sSource,
                                            'data': aoData,
                                            'success': fnCallback
                                        });

                                    },
                                    'aoButtons': [{ "title": "Set As Landing", "icons": "dashboard   ", "url": null, "confirm": "", "select": 0, "action": "srtdash" }, { "title": "Delete", "icons": "trash", "url": null, "confirm": "", "select": 0, "action": "delete" }],
                                    'aoDatalistButtons': {},
                                    'aoDatalistForm': {},
                                    'aoDatalistDna': {},
                                    'rowSelection': 'multiple',
                                    'aoColumnDefs': [{ 'aTargets': [0], 'mRender': function(data, type, full) { return '<span class="row-check"></span>' } }]
                                }, {
                                    'fnHeaderCallback': function() {
                                        $me.find('.dataTables_wrapper, .vizTileContainer').unblock();
                                        $('.data-table').trigger('ajaxDone');
                                        $('.dataTables_wrapper ').closest('.widget-content').css('overflow-y', 'hidden');
                                    }
                                }, {
                                    'fnInitComplete': function() {
                                        $me.find('.dataTables_wrapper, .vizTileContainer').unblock();
                                        $('.dataTables_filter').find('input').addClass('form-control');
                                        $('.tip-top').tooltip({ placement: 'top', container: 'body:first' });
                                        $('.dataTables_filter label').contents().filter(function() { return this.nodeType == 3 }).each(function() { this.textContent = this.textContent.replace('Search:', ''); });
                                        $('.dataTables_filter label input').attr('placeholder', 'Find');
                                    }
                                }, {
                                    'fnPreDrawCallback': function() {
                                        $me.find('.vizTileContainer').block(new loderconf);
                                        $me.find('.dataTables_wrapper').block({ "message": "<div class=\"pageloader cDtable\" style=\"height:auto\"><i style=\"color: #C4C4C4;\" class=\"fa fa-spinner font_40 fa-spin\"><\/i><\/div>", "centerY": true, "css": { "width": "30%", "top": "150px", "left": "", "right": "10px", "border": "none", "padding": "0px", "backgroundColor": "", "opacity": "1", "color": "#FFF" }, "overlayCSS": { "backgroundColor": "#FFF", "opacity": "0.1", "margin": "0px 0 0" } });
                                    }
                                })).not(':has(tr td.dataTables_empty)').on('click', 'thead span.row-check.multiple:first', function(ev) {
                                    $(this).toggleClass('selected');
                                    $(ev.delegateTarget).find('tbody > tr').toggleClass('selected', $(this).hasClass('selected'));
                                }).on('click', 'tbody > tr', function(ev) {
                                    $(this).toggleClass('selected');
                                    _all = $(this).siblings('tr').addBack();
                                    rows_count = _all.length;
                                    $(ev.delegateTarget).find('thead span.row-check.multiple:first').toggleClass('selected', rows_count == _all.filter('.selected').length);
                                });
                            } catch (e) {
                                console.log(e);
                                $app.setError();
                            }
                        })($("#2552db0ac90a0b7cd3f915cb4220f2e1"));
                    } catch (e) {
                        console.log(e);
                        $app.setError();
                    }
                })($("#6de12f82fc6b5bf67e6018e792d0945e"));
                (function($me) {
                    try { $me.each(sys_controllers_ls_favorite); } catch (e) {
                        console.log(e);
                        $app.setError();
                    }
                })($("#1e1bc3e67cfdcbb8ac78031d5b19fc27"));
                (function($me) {
                    try {
                        $('.viz_viz_viz_bton').attr({ 'data-width': '99%', 'data-height': '95%' });
                        (function($me) {
                            try {
                                $me.data('json-conf', { "actions": { "add": { "Hash": "e597fae890acf0922b252ae5402c64d3", "Name": "add", "Title": "Add Record ", "IconClass": "plus ssform viz_viz_viz_bton hide", "Url": "\/analytics\/form.preview\/5c0522108f7c44710c7b23c6\/r-625-49?_ls=188-2", "Link": true, "Confirm": "", "Select": [0, 0] } }, "variables": "a:18:{s:7:\"columns\";a:5:{s:16:\"vizGlobalActions\";s:16:\"vizGlobalActions\";s:8:\"Template\";s:8:\"Template\";s:11:\"Beneficiary\";s:11:\"Beneficiary\";s:10:\"Created At\";s:10:\"Created On\";s:6:\"Status\";s:6:\"Status\";}s:5:\"objId\";s:24:\"5b7275978b586b93007b2415\";s:11:\"source_type\";s:2:\"SS\";s:11:\"content_key\";a:1:{s:6:\"cnt-id\";s:9:\"11-49-625\";}s:15:\"filterCondition\";s:24:\"UUID::2546$@$rules::true\";s:12:\"formLinkConf\";a:3:{s:6:\"status\";s:7:\"enabled\";s:7:\"form-id\";s:24:\"5c0522108f7c44710c7b23c6\";s:10:\"gridObjKey\";s:3:\"625\";}s:14:\"tagSettingConf\";a:2:{s:6:\"status\";s:7:\"enabled\";s:13:\"tagColumnList\";a:2:{i:0;s:32:\"882a41482423e16951bb46a8d763b86c\";i:1;s:32:\"945c9b56855124c0fc8f23a3867be17c\";}}s:6:\"keyArr\";a:1:{s:6:\"cnt-id\";s:9:\"11-49-625\";}s:10:\"rowButtons\";s:0:\"\";s:17:\"tagMsgFilterRowId\";s:0:\"\";s:8:\"pageSize\";i:10;s:16:\"pGridViewEnabled\";b:0;s:11:\"userprofile\";a:1:{s:6:\"status\";s:8:\"disabled\";}s:10:\"expandConf\";b:0;s:5:\"dnaId\";s:0:\"\";s:4:\"qStr\";s:5:\"188-2\";s:8:\"formMode\";s:0:\"\";s:14:\"ruleFilterConf\";s:0:\"\";}" }).each(sys_ui_widgets_grids_grid);
                                dtl['49-625'] = $me.find('.dTable.data-table').dataTable($.extend({ "aoColumns": [{ "sName": 0, "mData": "_0", "bSortable": false }, { "sName": 1, "mData": "_1" }, { "sName": 2, "mData": "_2" }, { "sName": 3, "mData": "_3" }, { "sName": 4, "mData": "_4" }], "bJQueryUI": true, "bSortClasses": false, "bStateSave": false, "sScrollX": "100%", "sScrollY": "", "bServerSide": true, "bProcessing": true, "bInfo": true, "bDeferRender": true, "bAutoWidth": false, "bColDataWidth": false, "bcolumnGroup": false, "bcolumnSort": false, "bColumnGroupDefault": null, "bDatalistOrigin": "default", "bFilter": true, "bPaginate": true, "aaSorting": [], "dataListActionBtns": true, "sDom": "lfrtip", "bLengthChange": false, "iDisplayLength": 10, "sCookiePrefix": "vui-grid-", "sPaginationType": "full", "sServerMethod": "POST", "sAjaxSource": "\/sys\/ui\/widgets\/grids\/datatable.cb\/a%3A2%3A%7Bi%3A0%3Bs%3A40%3A%22Sys%5CControllers%5CLs%5CLiveapps%5CGrid%5CView_ss%22%3Bi%3A1%3Bs%3A10%3A%22gridSource%22%3B%7D", "oLanguage": { "sInfo": "Showing _START_ to _END_ of _TOTAL_ records.", "sInfoEmpty": "No entries to show", "sZeroRecords": "No records to display.", "sLoadingRecords": "Please wait - loading...", "sSearch": "" } }, {
                                        'fnServerData': function(sSource, aoData, fnCallback, oSettings) {
                                            aoData.push({ 'name': 'variables', 'value': "a:18:{s:7:\"columns\";a:5:{s:16:\"vizGlobalActions\";s:16:\"vizGlobalActions\";s:8:\"Template\";s:8:\"Template\";s:11:\"Beneficiary\";s:11:\"Beneficiary\";s:10:\"Created At\";s:10:\"Created On\";s:6:\"Status\";s:6:\"Status\";}s:5:\"objId\";s:24:\"5b7275978b586b93007b2415\";s:11:\"source_type\";s:2:\"SS\";s:11:\"content_key\";a:1:{s:6:\"cnt-id\";s:9:\"11-49-625\";}s:15:\"filterCondition\";s:24:\"UUID::2546$@$rules::true\";s:12:\"formLinkConf\";a:3:{s:6:\"status\";s:7:\"enabled\";s:7:\"form-id\";s:24:\"5c0522108f7c44710c7b23c6\";s:10:\"gridObjKey\";s:3:\"625\";}s:14:\"tagSettingConf\";a:2:{s:6:\"status\";s:7:\"enabled\";s:13:\"tagColumnList\";a:2:{i:0;s:32:\"882a41482423e16951bb46a8d763b86c\";i:1;s:32:\"945c9b56855124c0fc8f23a3867be17c\";}}s:6:\"keyArr\";a:1:{s:6:\"cnt-id\";s:9:\"11-49-625\";}s:10:\"rowButtons\";s:0:\"\";s:17:\"tagMsgFilterRowId\";s:0:\"\";s:8:\"pageSize\";i:10;s:16:\"pGridViewEnabled\";b:0;s:11:\"userprofile\";a:1:{s:6:\"status\";s:8:\"disabled\";}s:10:\"expandConf\";b:0;s:5:\"dnaId\";s:0:\"\";s:4:\"qStr\";s:5:\"188-2\";s:8:\"formMode\";s:0:\"\";s:14:\"ruleFilterConf\";s:0:\"\";}" });
                                            oSettings.jqXHR = $.ajax({
                                                'dataType': 'json',
                                                'type': 'POST',
                                                'url': sSource,
                                                'data': aoData,
                                                'success': fnCallback,

                                            });

                                        },
                                        'aoButtons': [{ "title": "Add Record ", "icons": "plus ssform viz_viz_viz_bton hide", "url": "\/analytics\/form.preview\/5c0522108f7c44710c7b23c6\/r-625-49?_ls=188-2", "confirm": "", "select": 0, "action": "add" }],
                                        'aoDatalistButtons': {},
                                        'aoDatalistForm': {},
                                        'aoDatalistDna': {},
                                        'rowSelection': 'none',
                                        'aoColumnDefs': ''
                                    },

                                    {
                                        'fnHeaderCallback': function() {
                                            $me.find('.dataTables_wrapper, .vizTileContainer').unblock();
                                            $('.dataTables_wrapper ').closest('.widget-content').css('overflow-y', 'hidden');
                                            $('.dataTables_filter').find('input').addClass('form-control');
                                        }
                                    }, { 'fnInitComplete': function(nRow, aData, iDataIndex) {} }, {
                                        'fnInitComplete': function() {
                                            $me.find('.dataTables_wrapper, .vizTileContainer').unblock();
                                            jQuery('.dataTable  .numeric:not(".done")').each(function() { jQuery(this).html(numeral(jQuery(this).data('value')).format(jQuery(this).data('format'))).addClass('done') });
                                            $('.dataTables_filter').find('input').addClass('form-control');
                                            $('.tip-top').tooltip({ placement: 'top', container: 'body:first' });
                                            $('.tip-top').tooltip({ placement: 'top' });
                                            $('.data-table').trigger('ajaxDone');
                                            $('.dataTables_filter label').contents().filter(function() { return this.nodeType == 3 }).each(function() { this.textContent = this.textContent.replace('Search:', ''); });
                                            $('.dataTables_filter label input').attr('placeholder', 'Find');
                                        }
                                    }, {
                                        'fnPreDrawCallback': function() {
                                            $me.find('.vizTileContainer').block(new loderconf);
                                            $me.find('.dataTables_wrapper').block({ "message": "<div class=\"pageloader cDtable\" style=\"height:auto\"><i style=\"color: #C4C4C4;\" class=\"fa fa-spinner font_40 fa-spin\"><\/i><\/div>", "centerY": true, "css": { "width": "30%", "top": "150px", "left": "", "right": "10px", "border": "none", "padding": "0px", "backgroundColor": "", "opacity": "1", "color": "#FFF" }, "overlayCSS": { "backgroundColor": "#FFF", "opacity": "0.1", "margin": "0px 0 0" } });
                                        },
                                    }
                                ));
                            } catch (e) {
                                console.log(e);
                                $app.setError();
                            }
                        })($("#6cd406e32ec9e944009237363fc89908"));
                    } catch (e) {
                        console.log(e);
                        $app.setError();
                    }
                })($("#b5defc830b0bc272622b4102dc8ded79"));
                (function($me) {
                    try {
                        $('.viz_viz_viz_bton').attr({ 'data-width': '99%', 'data-height': '95%' });
                        (function($me) {
                            try {
                                $me.data('json-conf', { "actions": { "add": { "Hash": "151a586dbb69a7e3ea09cc92d6475b53", "Name": "add", "Title": "Add Record ", "IconClass": "plus ssform viz_viz_viz_bton hide", "Url": "\/analytics\/form.preview\/5bee9ae48f7c4454087b23cc\/r-539-49?_ls=188-2", "Link": true, "Confirm": "", "Select": [0, 0] } }, "variables": "a:18:{s:7:\"columns\";a:5:{s:16:\"vizGlobalActions\";s:16:\"vizGlobalActions\";s:4:\"UUID\";s:4:\"UUID\";s:15:\"Primary Insured\";s:15:\"Primary Insured\";s:11:\"Document ID\";s:11:\"Document ID\";s:12:\"Carrier Name\";s:12:\"Carrier Name\";}s:5:\"objId\";s:24:\"5b7275978b586b93007b2416\";s:11:\"source_type\";s:2:\"SS\";s:11:\"content_key\";a:1:{s:6:\"cnt-id\";s:9:\"11-49-539\";}s:15:\"filterCondition\";s:24:\"UUID::2546$@$rules::true\";s:12:\"formLinkConf\";a:3:{s:6:\"status\";s:7:\"enabled\";s:7:\"form-id\";s:24:\"5bee9ae48f7c4454087b23cc\";s:10:\"gridObjKey\";s:3:\"539\";}s:14:\"tagSettingConf\";a:1:{s:6:\"status\";s:8:\"disabled\";}s:6:\"keyArr\";a:1:{s:6:\"cnt-id\";s:9:\"11-49-539\";}s:10:\"rowButtons\";s:0:\"\";s:17:\"tagMsgFilterRowId\";s:0:\"\";s:8:\"pageSize\";i:10;s:16:\"pGridViewEnabled\";b:0;s:11:\"userprofile\";a:1:{s:6:\"status\";s:8:\"disabled\";}s:10:\"expandConf\";b:0;s:5:\"dnaId\";s:0:\"\";s:4:\"qStr\";s:5:\"188-2\";s:8:\"formMode\";s:0:\"\";s:14:\"ruleFilterConf\";s:0:\"\";}" }).each(sys_ui_widgets_grids_grid);
                                dtl['49-539'] = $me.find('.dTable.data-table').dataTable($.extend({ "aoColumns": [{ "sName": 0, "mData": "_0", "bSortable": false }, { "sName": 1, "mData": "_1" }, { "sName": 2, "mData": "_2" }, { "sName": 3, "mData": "_3" }, { "sName": 4, "mData": "_4" }], "bJQueryUI": true, "bSortClasses": false, "bStateSave": false, "sScrollX": "100%", "sScrollY": "", "bServerSide": true, "bProcessing": true, "bInfo": true, "bDeferRender": true, "bAutoWidth": false, "bColDataWidth": false, "bcolumnGroup": false, "bcolumnSort": false, "bColumnGroupDefault": null, "bDatalistOrigin": "default", "bFilter": true, "bPaginate": true, "aaSorting": [], "dataListActionBtns": true, "sDom": "lfrtip", "bLengthChange": false, "iDisplayLength": 10, "sCookiePrefix": "vui-grid-", "sPaginationType": "full", "sServerMethod": "POST", "sAjaxSource": "\/sys\/ui\/widgets\/grids\/datatable.cb\/a%3A2%3A%7Bi%3A0%3Bs%3A40%3A%22Sys%5CControllers%5CLs%5CLiveapps%5CGrid%5CView_ss%22%3Bi%3A1%3Bs%3A10%3A%22gridSource%22%3B%7D", "oLanguage": { "sInfo": "Showing _START_ to _END_ of _TOTAL_ records.", "sInfoEmpty": "No entries to show", "sZeroRecords": "No records to display.", "sLoadingRecords": "Please wait - loading...", "sSearch": "" } }, {
                                        'fnServerData': function(sSource, aoData, fnCallback, oSettings) {
                                            aoData.push({ 'name': 'variables', 'value': "a:18:{s:7:\"columns\";a:5:{s:16:\"vizGlobalActions\";s:16:\"vizGlobalActions\";s:4:\"UUID\";s:4:\"UUID\";s:15:\"Primary Insured\";s:15:\"Primary Insured\";s:11:\"Document ID\";s:11:\"Document ID\";s:12:\"Carrier Name\";s:12:\"Carrier Name\";}s:5:\"objId\";s:24:\"5b7275978b586b93007b2416\";s:11:\"source_type\";s:2:\"SS\";s:11:\"content_key\";a:1:{s:6:\"cnt-id\";s:9:\"11-49-539\";}s:15:\"filterCondition\";s:24:\"UUID::2546$@$rules::true\";s:12:\"formLinkConf\";a:3:{s:6:\"status\";s:7:\"enabled\";s:7:\"form-id\";s:24:\"5bee9ae48f7c4454087b23cc\";s:10:\"gridObjKey\";s:3:\"539\";}s:14:\"tagSettingConf\";a:1:{s:6:\"status\";s:8:\"disabled\";}s:6:\"keyArr\";a:1:{s:6:\"cnt-id\";s:9:\"11-49-539\";}s:10:\"rowButtons\";s:0:\"\";s:17:\"tagMsgFilterRowId\";s:0:\"\";s:8:\"pageSize\";i:10;s:16:\"pGridViewEnabled\";b:0;s:11:\"userprofile\";a:1:{s:6:\"status\";s:8:\"disabled\";}s:10:\"expandConf\";b:0;s:5:\"dnaId\";s:0:\"\";s:4:\"qStr\";s:5:\"188-2\";s:8:\"formMode\";s:0:\"\";s:14:\"ruleFilterConf\";s:0:\"\";}" });
                                            oSettings.jqXHR = $.ajax({
                                                'dataType': 'json',
                                                'type': 'POST',
                                                'url': sSource,
                                                'data': aoData,
                                                'success': fnCallback,

                                            });

                                        },
                                        'aoButtons': [{ "title": "Add Record ", "icons": "plus ssform viz_viz_viz_bton hide", "url": "\/analytics\/form.preview\/5bee9ae48f7c4454087b23cc\/r-539-49?_ls=188-2", "confirm": "", "select": 0, "action": "add" }],
                                        'aoDatalistButtons': {},
                                        'aoDatalistForm': {},
                                        'aoDatalistDna': {},
                                        'rowSelection': 'none',
                                        'aoColumnDefs': ''
                                    },

                                    {
                                        'fnHeaderCallback': function() {
                                            $me.find('.dataTables_wrapper, .vizTileContainer').unblock();
                                            $('.dataTables_wrapper ').closest('.widget-content').css('overflow-y', 'hidden');
                                            $('.dataTables_filter').find('input').addClass('form-control');
                                        }
                                    }, { 'fnInitComplete': function(nRow, aData, iDataIndex) {} }, {
                                        'fnInitComplete': function() {
                                            $me.find('.dataTables_wrapper, .vizTileContainer').unblock();
                                            jQuery('.dataTable  .numeric:not(".done")').each(function() { jQuery(this).html(numeral(jQuery(this).data('value')).format(jQuery(this).data('format'))).addClass('done') });
                                            $('.dataTables_filter').find('input').addClass('form-control');
                                            $('.tip-top').tooltip({ placement: 'top', container: 'body:first' });
                                            $('.tip-top').tooltip({ placement: 'top' });
                                            $('.data-table').trigger('ajaxDone');
                                            $('.dataTables_filter label').contents().filter(function() { return this.nodeType == 3 }).each(function() { this.textContent = this.textContent.replace('Search:', ''); });
                                            $('.dataTables_filter label input').attr('placeholder', 'Find');
                                        }
                                    }, {
                                        'fnPreDrawCallback': function() {
                                            $me.find('.vizTileContainer').block(new loderconf);
                                            $me.find('.dataTables_wrapper').block({ "message": "<div class=\"pageloader cDtable\" style=\"height:auto\"><i style=\"color: #C4C4C4;\" class=\"fa fa-spinner font_40 fa-spin\"><\/i><\/div>", "centerY": true, "css": { "width": "30%", "top": "150px", "left": "", "right": "10px", "border": "none", "padding": "0px", "backgroundColor": "", "opacity": "1", "color": "#FFF" }, "overlayCSS": { "backgroundColor": "#FFF", "opacity": "0.1", "margin": "0px 0 0" } });
                                        },
                                    }
                                ));
                            } catch (e) {
                                console.log(e);
                                $app.setError();
                            }
                        })($("#10492bb22c45cc771be5006d31ab1f90"));
                    } catch (e) {
                        console.log(e);
                        $app.setError();
                    }
                })($("#99c6b8067dd35edb520dbbfdab2cb6ee"));
                (function($me) {
                    try {
                        var previousPoint = null;
                        $me.addClass('chart');
                        vizCharts['49-655'] = $me.highcharts({ "chart": { "plotBackgroundColor": null, "plotBorderWidth": null, "plotShadow": false }, "title": { "text": "" }, "plotOptions": { "pie": { "allowPointSelect": true, "cursor": "pointer", "events": { "click": "yes" }, "dataLabels": { "enabled": false, "format": "<b>{point.name}({point.y})<\/b>: {point.percentage:.1f} %" } } }, "series": [{ "type": "pie", "name": "Cash Surrender Value", "data": [{ "name": "Mark Jones", "y": 0 }, { "name": "Justin M Worden", "y": 0 }] }], "credits": { "text": "", "href": "" }, "yAxis": { "gridLineWidth": 0 } });
                    } catch (e) {
                        console.log(e);
                        $app.setError();
                    }
                })($("#dbe8b2e7e7d8ebdd8387833d656420a1"));
                (function($me) {
                    try {
                        var previousPoint = null;
                        $me.addClass('chart');
                        vizCharts['49-656'] = $me.highcharts({ "chart": { "type": "column" }, "title": { "text": "" }, "xAxis": { "title": { "text": "" }, "categories": ["Mark Jones", "Justin M Worden"], "colheader": "Primary Insured" }, "yAxis": { "title": { "text": "" }, "gridLineWidth": 0 }, "plotOptions": { "series": { "cursor": "pointer", "events": { "click": "yes" } } }, "series": [{ "name": "Death Benefit", "data": [0, 200000] }], "credits": { "text": "", "href": "" }, "colors": ["#04c27d", "#f2b835", "#6c8eaf", "#4c5d87", "#89A54E", "#80699B", "#3D96AE"] });
                    } catch (e) {
                        console.log(e);
                        $app.setError();
                    }
                })($("#95a22abfe2b469e16a861c35a38b6274"));
            } catch (e) {
                console.log(e);
                $app.setError();
            }
        })($("#f0a22b62f13af524184bf3f4fb157f2f"));
        (function($me) {
            try {

                xtid = "11";
                xuid = "lucas@vizru.com";
                hot3Conf['49-476-1-0-1_1'] = {
                    SPdata: [
                        ["10ca613871dc1d047dc478a9d90c95f9", "UUID", "UID", "PolicyID", "BeneficaryName", "InsuredID", "InsuredName", "PrimaryInsured", "OwnerID", "Owner", "HTML", "CarrierName", "PolicyPremium", "AnnualPremium", "AnnualPolicyFee", "YTDPremium", "CashSurrValue", "PolicyBenefit", "PolicyDate", "marked", "SelectBox"],
                        ["c48abba07bee6c72e0601cb2fd20077c", "2546", "188", "N560014610", "Worden, Justin", "", "Lee M Fabbiano", "Lee M Fabbiano", "6490", "Fabbiano, Lee", "", "Nationwide Financial", "", "0", "", "", "", "", "", 1, "<label class=\"customcheck1\"> <input data-docid=\"N560014610\" type=\"checkbox\" class=\"kiosk-docs\" checked> <span class=\"checkmark customcheck1\"><\/span> <\/label>"],
                        ["0506330683e8788233b1ddd16aee2ed1", "2546", "188", "VP65790910", "", "", "Lee M Fabbiano", "Lee M Fabbiano", "6495", "Fabbiano, Lee", "", "Pacific Life Insurance Company", "", "0", "", "", "", "", "", 1, "<label class=\"customcheck1\"> <input data-docid=\"VP65790910\" type=\"checkbox\" class=\"kiosk-docs\" checked> <span class=\"checkmark customcheck1\"><\/span> <\/label>"],
                        ["15c428d1339db440789e1eb01592535f", "2546", "188", "E2E_Case3_Demo", "", "", "Lee M Fabbiano", "Lee M Fabbiano", "6505", "Fabbiano, Lee", "", "M Life", "", "0", "", "", "", "1500000", "", 0, "<label class=\"customcheck1\"> <input data-docid=\"E2E_Case3_Demo\" type=\"checkbox\" class=\"kiosk-docs\"> <span class=\"checkmark customcheck1\"><\/span> <\/label>"]
                    ],
                    xdata: [
                        ["10ca613871dc1d047dc478a9d90c95f9", "UUID", "UID", "PolicyID", "BeneficaryName", "InsuredID", "InsuredName", "PrimaryInsured", "OwnerID", "Owner", "HTML", "CarrierName", "PolicyPremium", "AnnualPremium", "AnnualPolicyFee", "YTDPremium", "CashSurrValue", "PolicyBenefit", "PolicyDate", "marked", "SelectBox"],
                        ["c48abba07bee6c72e0601cb2fd20077c", "2546", "188", "N560014610", "Worden, Justin", "", "Lee M Fabbiano", "Lee M Fabbiano", "6490", "Fabbiano, Lee", "", "Nationwide Financial", "", "0", "", "", "", "", "", 1, "<label class=\"customcheck1\"> <input data-docid=\"N560014610\" type=\"checkbox\" class=\"kiosk-docs\" checked> <span class=\"checkmark customcheck1\"><\/span> <\/label>"],
                        ["0506330683e8788233b1ddd16aee2ed1", "2546", "188", "VP65790910", "", "", "Lee M Fabbiano", "Lee M Fabbiano", "6495", "Fabbiano, Lee", "", "Pacific Life Insurance Company", "", "0", "", "", "", "", "", 1, "<label class=\"customcheck1\"> <input data-docid=\"VP65790910\" type=\"checkbox\" class=\"kiosk-docs\" checked> <span class=\"checkmark customcheck1\"><\/span> <\/label>"],
                        ["15c428d1339db440789e1eb01592535f", "2546", "188", "E2E_Case3_Demo", "", "", "Lee M Fabbiano", "Lee M Fabbiano", "6505", "Fabbiano, Lee", "", "M Life", "", "0", "", "", "", "1500000", "", 0, "<label class=\"customcheck1\"> <input data-docid=\"E2E_Case3_Demo\" type=\"checkbox\" class=\"kiosk-docs\"> <span class=\"checkmark customcheck1\"><\/span> <\/label>"]
                    ],
                    settingsConf: { "10": "datatype", "18": "datatype", "19": "datatype", "20": "datatype" },

                    settingsConfType: { "10": "html", "18": "date", "19": "numeric", "20": "html" },

                    settingsConfFormat: { "10": "", "18": "YYYY-MM-DD", "19": "", "20": "" },

                    settingsColEventConf: [],

                    settingsColumnValidateConf: [],

                    settingsColumnLinkConf: [],

                    settingsReadOnlyColConf: [],

                    settingsDefColValueConf: [],

                    settingsColFormulaConf: [],
                    generalSettings: { "rowsize": 50, "lockHeader": false, "lockColumnOperation": false, "pagination": true, "pageSize": 50, "totalrecordcount": 3 }


                }

                generalSettings = { "rowsize": 50, "lockHeader": false, "lockColumnOperation": false, "pagination": true, "pageSize": 50, "totalrecordcount": 3 };

                if (hot3Conf['49-476-1-0-1_1'].generalSettings.mincolwidth !== undefined) {
                    var mincolWidths = hot3Conf['49-476-1-0-1_1'].generalSettings.mincolwidth;
                } else {
                    var mincolWidths = 150;
                }

                /*Cal pagination*/
                if (hot3Conf['49-476-1-0-1_1'].generalSettings.pagination == true) {
                    buildSSpagination(
                        hot3Conf['49-476-1-0-1_1'].generalSettings.totalrecordcount,
                        hot3Conf['49-476-1-0-1_1'].generalSettings.pageSize,
                        "sheet-49-476-1-0-1_1",
                        (hot3Conf['49-476-1-0-1_1'].SPdata.length - 1)
                    );
                }


                var renderState = false;
                var validationOnLoadStatus = false;

                var pSpredId = "49-476-1-0-1_1";
                var container = document.getElementById('sheet-' + pSpredId);

                var colsToHide = [0];

                function getCustomRenderer() {
                    return function(instance, td, row, col, prop, value, cellProperties) {
                        if (colsToHide.indexOf(col) > -1) {
                            cellProperties.copyable = false;
                            cellProperties.colWidths = 1;
                        }
                        Handsontable.renderers.TextRenderer.apply(this, arguments);
                    }
                }
                var yellowRenderer = function(instance, td, row, col, prop, value, cellProperties) {
                    td.style.backgroundColor = 'yellow';
                    return td;
                };

                /*Custom edit function for LINK type column*/
                var LinkEditor = Handsontable.editors.TextEditor.prototype.extend();

                LinkEditor.prototype.getValue = function() {
                    if (this.col in hot3Conf['49-476-1-0-1_1'].settingsColumnLinkConf) {
                        return '<a class=" ajax vizLSSSLink" data-width="90%" title="Detail View" href="/ls/livespace/spreadsheet.sslink/' + hot3Conf['49-476-1-0-1_1'].settingsColumnLinkConf[this.col][0]['obj-id'] + '/' + hot3Conf['49-476-1-0-1_1'].settingsColumnLinkConf[this.col][0]['linkto'] + '/' + this.TEXTAREA.value + '" >' + this.TEXTAREA.value + '</a>';
                    } else {
                        return '<a  >' + this.TEXTAREA.value + '</a>';
                    }
                };

                LinkEditor.prototype.setValue = function(newValue) {
                    var regex = /(<([^>]+)>)/ig
                    var modiValue = newValue.replace(regex, "");
                    this.TEXTAREA.value = modiValue;
                };

                var coldef = [];
                var cellChanges = [];
                var newRowsIndexs = [];
                var multicellUpdate = false;

                function rowCalc() {
                    var rval;
                    var rowCalcValve = ((parseInt(generalSettings.rowsize) + (7 / parseInt(generalSettings.rowsize))) * 23.765) - 5 + (1 / parseInt(generalSettings.rowsize));
                    var wHeight = ($(window).height() - 200);
                    if (rowCalcValve >= wHeight) { rval = wHeight } else { rval = rowCalcValve; }
                    return rval;
                };
                /* Dynamic Column Validation function creation*/


                function functionCellValidator(spid, colIndex, colValue) {
                    if (hot3Conf[spid].settingsColumnLinkConf[colIndex]) {
                        colValue = $(colValue).text();
                    }
                    var result = true;
                    var colValidConf = hot3Conf[spid].settingsColumnValidateConf[colIndex];
                    $.each(colValidConf, function(vType, vConf) {
                        switch (vType) {
                            case 'numeric_validation':
                                if ('min_value' in vConf && 'max_value' in vConf) {
                                    if (colValue < vConf['min_value'] || colValue > vConf['max_value']) {
                                        result = false;
                                    }
                                } else if ('min_value' in vConf) {
                                    if (colValue < vConf['min_value']) {
                                        result = false;
                                    }
                                } else if ('max_value' in vConf) {
                                    if (colValue > vConf['max_value']) {
                                        result = false;
                                    }
                                }

                                if (result == true) {
                                    if ('char_length_min' in vConf && 'char_length_max' in vConf) {
                                        if (colValue.toString().length < vConf['char_length_min'] || colValue.toString().length > vConf['char_length_max']) {
                                            result = false;
                                        }
                                    } else if ('char_length_min' in vConf) {
                                        if (colValue.toString().length < vConf['char_length_min']) {
                                            result = false;
                                        }
                                    } else if ('char_length_max' in vConf) {
                                        if (colValue.toString().length > vConf['char_length_max']) {
                                            result = false;
                                        }
                                    }
                                }
                                break;

                            case 'text_validation':
                                if (colValue == undefined) {
                                    colValue = '';
                                }
                                if ('in_list' in vConf) {
                                    if (jQuery.inArray(colValue.toLowerCase(), vConf['in_list']) < 0) {
                                        result = false;
                                    }
                                } else if ('notin_list' in vConf) {
                                    if (jQuery.inArray(colValue.toLowerCase(), vConf['notin_list']) > -1) {
                                        result = false;
                                    }
                                }

                                if (result == true) {
                                    if ('char_length_min' in vConf && 'char_length_max' in vConf) {
                                        if (colValue.toString().length < vConf['char_length_min'] || colValue.toString().length > vConf['char_length_max']) {
                                            result = false;
                                        }
                                    } else if ('char_length_min' in vConf) {
                                        if (colValue.toString().length < vConf['char_length_min']) {
                                            result = false;
                                        }
                                    } else if ('char_length_max' in vConf) {
                                        if (colValue.toString().length > vConf['char_length_max']) {
                                            result = false;
                                        }
                                    }
                                }
                                break;
                            case 'date_validation':
                                var columnDtFormat = 'MM/DD/YYYY';
                                if (colIndex in hot3Conf[spid].settingsConfFormat) {
                                    columnDtFormat = hot3Conf[spid].settingsConfFormat[colIndex];
                                }
                                if (columnDtFormat == '') {
                                    columnDtFormat = 'MM/DD/YYYY';
                                }
                                var tmpColValue = moment(colValue, columnDtFormat);
                                if (tmpColValue == undefined || !tmpColValue.isValid()) {
                                    result = false;
                                } else {
                                    var tmpColValue = tmpColValue.format('YYYY-MM-DD');
                                    if ('min_date' in vConf && 'max_date' in vConf) {
                                        var min_dt = moment(vConf['min_date']).format('YYYY-MM-DD');
                                        var max_dt = moment(vConf['max_date']).format('YYYY-MM-DD');
                                        if (tmpColValue < min_dt || tmpColValue > max_dt) {
                                            result = false;
                                        }
                                    } else if ('min_date' in vConf) {
                                        var min_dt = moment(vConf['min_date']).format('YYYY-MM-DD');
                                        if (tmpColValue < min_dt) {
                                            result = false;
                                        }
                                    } else if ('max_date' in vConf) {
                                        var max_dt = moment(vConf['max_date']).format('YYYY-MM-DD');
                                        if (tmpColValue > max_dt) {
                                            result = false;
                                        }
                                    }

                                }
                                break;
                        }
                    });
                    return result;
                }

                function customDateValidator(value, callback) {
                    if (!value && this.allowEmpty) {
                        callback(true);
                    } else {
                        Handsontable.DateValidator.call(this, value, callback);
                    }
                }

                function customDropdownValidator(value, callback) {
                    if (!value && this.allowEmpty) {
                        callback(true);
                    } else {
                        Handsontable.AutocompleteValidator.call(this, value, callback);
                    }
                }
                if (hot3Conf['49-476-1-0-1_1'].generalSettings.fixedColumnCheck == true) {
                    var fixedColumn_key = hot3Conf['49-476-1-0-1_1'].generalSettings.fixedColumn_key;
                } else {
                    var fixedColumn_key = false;
                }
                var sheetnew = {
                    data: hot3Conf['49-476-1-0-1_1'].SPdata,
                    height: 315,
                    minCols: 10,

                    minRows: hot3Conf['49-476-1-0-1_1'].generalSettings.pageSize,


                    minSpareRows: 5,
                    rowHeights: 35,
                    visibleRows: 8,
                    colHeaders: true,
                    rowHeaders: true,
                    stretchH: 'all',
                    autoColumnSize: true,
                    manualColumnResize: true,
                    outsideClickDeselects: false,
                    colWidths: mincolWidths,
                    columnSorting: false,
                    formulas: true,
                    fixedRowsTop: 1,
                    fixedColumnsLeft: fixedColumn_key + 1,
                    contextMenu: {
                        callback: function(key, options) {
                            if (key === 'rowhistory') {
                                handsontableRowHistory();
                            }
                            if (key === 'rowview') {
                                var obj_id = "49-476-1-0-1_1";
                                var ssid_str = "5baf22088f7c443014cff18b-1-0-1_1";

                                handsontableRowView(obj_id, ssid_str);
                            }
                            if (key === 'tagview') {



                                var instance = this.getInstance();
                                var colIndexlist = instance.countCols();
                                var colIndexlistArray = [];
                                for (i = 1; i <= colIndexlist; i++)
                                    colIndexlistArray[i] = i;
                                rightBarFn().open("messages");
                                generateTags(options.start, this.getDataAtCell(options.start.row, 0), this.getDataAtCell, colIndexlistArray, hot3Conf['49-476-1-0-1_1'].generalSettings, instance);


                            }
                        },
                        items: {


                            "rowview": {
                                name: 'Row Detailed View',
                                disabled: function() {
                                    /* Disable for first row */
                                    return (hot3['49-476-1-0-1_1'].getSelected()[0] === 0);
                                }
                            },
                            "tagview": {
                                name: 'Tag to message',
                                disabled: function() {
                                    return (hot3['49-476-1-0-1_1'].getSelected()[0] === 0);
                                }
                            },
                            "remove_row": {
                                disabled: function() {
                                    /*if first row, disable this option*/
                                    return (hot3['49-476-1-0-1_1'].getSelected()[0] === 0)
                                }
                            }


                        }
                    },
                    cells: function(row, col, prop) {
                        var cellProperties = {};
                        if (_.indexOf(Object.keys(hot3Conf), '49-476-1-0-1_1') !== -1) {
                            if (col === 0) {
                                cellProperties.copyable = false;
                                cellProperties.colWidths = 1;
                                cellProperties.readOnly = true;
                            }
                            if (row == 0 && hot3Conf['49-476-1-0-1_1'].generalSettings.lockHeader == true) {
                                cellProperties.readOnly = true;
                            }





                            if (row != 0 && col in hot3Conf['49-476-1-0-1_1'].settingsConf) {
                                if (hot3Conf['49-476-1-0-1_1'].settingsConf[col] == "dropdown") {
                                    cellProperties.type = 'dropdown';
                                    cellProperties.source = hot3Conf['49-476-1-0-1_1'].settingsConfType[col];
                                    cellProperties.allowEmpty = true;
                                    cellProperties.validator = customDropdownValidator;
                                } else if (hot3Conf['49-476-1-0-1_1'].settingsConf[col] == "datatype") {

                                    if (hot3Conf['49-476-1-0-1_1'].settingsConfType[col] == 'date') {
                                        cellProperties.type = hot3Conf['49-476-1-0-1_1'].settingsConfType[col];
                                        cellProperties.dateFormat = hot3Conf['49-476-1-0-1_1'].settingsConfFormat[col];
                                        cellProperties.allowEmpty = true;
                                        cellProperties.validator = customDateValidator;
                                    } else if (hot3Conf['49-476-1-0-1_1'].settingsConfType[col] == 'datetime') {
                                        cellProperties.type = 'text';
                                        cellProperties.allowEmpty = true;
                                    } else if (hot3Conf['49-476-1-0-1_1'].settingsConfType[col] == 'html') {
                                        cellProperties.renderer = 'html';
                                    } else if (hot3Conf['49-476-1-0-1_1'].settingsConfType[col] == 'status') {
                                        //do nothing
                                    } else if (hot3Conf['49-476-1-0-1_1'].settingsConfType[col] == 'file') {
                                        cellProperties.copyable = false;
                                        cellProperties.readOnly = true;
                                    } else {
                                        cellProperties.type = hot3Conf['49-476-1-0-1_1'].settingsConfType[col];
                                        cellProperties.format = hot3Conf['49-476-1-0-1_1'].settingsConfFormat[col];
                                    }
                                    /* Disable normal numeric validator which col have custom validation */
                                } else if (hot3Conf['49-476-1-0-1_1'].settingsConf[col] == "columnlink" || hot3Conf['49-476-1-0-1_1'].settingsConf[col] == "dnalink") {
                                    cellProperties.renderer = 'html';
                                    cellProperties.editor = LinkEditor;

                                }

                            }






                            if (col in hot3Conf['49-476-1-0-1_1'].settingsColumnValidateConf && row > 0) {
                                var tmpCName = 'funcv_' + col + '_49-476-1-0-1_1';
                                var tmpFname = validateColumnFunctionObj[tmpCName];
                                cellProperties.validator = tmpFname;
                            }




                            if (hot3Conf['49-476-1-0-1_1'].settingsReadOnlyColConf.indexOf(col) != -1) {
                                cellProperties.readOnly = true;
                            }

                            if (col in hot3Conf['49-476-1-0-1_1'].settingsColFormulaConf && row > 0) {
                                cellProperties.readOnly = true;
                                cellProperties.copyable = false;
                            }





                        }
                        return cellProperties;
                    },
                    afterInit: function() {
                        renderState = true;
                    },

                    afterOnCellMouseDown: function(event, coords, TD) {





                        var instance = this.getInstance();
                        var rowCount = instance.countRows();
                        if (coords.row > (rowCount - 5)) {
                            if (hot3Conf['49-476-1-0-1_1'].settingsConf[coords.col] == "dropdown") {
                                $('.handsontableInputHolder').addClass('bottom');
                            }
                        } else {
                            $('.handsontableInputHolder').removeClass('bottom');
                        }
                    },

                    beforeChange: function(changes, source) {

                        /* No further actions, if the value is not changed*/

                        if (source == 'edit' && changes.length == 1 && changes[0][2] == changes[0][3]) {
                            changes = null;
                            source = 'noaction';
                            return false;
                        }

                        var selectedRange = this.getSelected();
                        if (lastKeyCode == "delete" && selectedRange[1] == 0) {

                            var selectRange = (selectedRange[2] - selectedRange[0]) + 1;

                            hot3['49-476-1-0-1_1'].alter('remove_row', selectedRange[0], selectRange);
                            hot3['49-476-1-0-1_1'].render();

                            changes = null;
                            source = 'delete';
                            lastKeyCode = '';
                            return false;

                        }

                        var instance = this.getInstance();
                        newRowsIndexs = []; /* array for store newly added rows index */
                        if (source == 'redo' || source == 'undo') {
                            return false;
                        }
                        if (changes.length > 1) {
                            multicellUpdate = true;
                        }
                        if (source == 'paste' || source == 'autofill' || multicellUpdate == true) {
                            var chLength = changes.length - 1;
                            var minRowIdx = changes[0][0];
                            var maxRowIdx = changes[chLength][0];

                            for (var modifyRowIndex = minRowIdx; modifyRowIndex <= maxRowIdx; modifyRowIndex++) {
                                var rowId = instance.getDataAtCell(modifyRowIndex, 0);

                                if (rowId == "" || rowId == null) {
                                    var i = Math.random();
                                    var xrowId = $app.md5(xtid + xuid + "'" + $.now() + i + "'");
                                    rowId = xrowId;
                                    changes.push([modifyRowIndex, 0, null, rowId]);

                                    /*Skip Default Col Value and Formula on HEADER ROW*/
                                    if (modifyRowIndex > 0) {
                                        for (var dCol in hot3Conf['49-476-1-0-1_1'].settingsDefColValueConf) {
                                            changes.push([modifyRowIndex, dCol, null, hot3Conf['49-476-1-0-1_1'].settingsDefColValueConf[dCol]]);
                                        }
                                        /* Add formula in columns if specified - Case : New Row*/


                                    }

                                    newRowsIndexs.push(modifyRowIndex);
                                }
                            }
                        } else {
                            var modifyRowIndex = changes[0][0];
                            var colIndex = changes[0][1];

                            if (colIndex == 0 && source != 'insert') {
                                return false; /* Skip on hidden fields (rowId) changes*/
                            }

                            var rowId = instance.getDataAtCell(modifyRowIndex, 0);

                            if (rowId == "" || rowId == null) {
                                var i = Math.random();
                                var xrowId = $app.md5(xtid + xuid + "'" + $.now() + i + "'");
                                rowId = xrowId;
                                changes.push([modifyRowIndex, 0, null, rowId]);

                                /*    Skip Default Col Value and Formula on HEADER ROW*/
                                if (modifyRowIndex > 0) {
                                    for (var dCol in hot3Conf['49-476-1-0-1_1'].settingsDefColValueConf) {
                                        changes.push([modifyRowIndex, dCol, null, hot3Conf['49-476-1-0-1_1'].settingsDefColValueConf[dCol]]);
                                    }
                                    /*  Add formula in columns if specified - Case : New Row*/


                                }

                                newRowsIndexs.push(modifyRowIndex);
                            } else {
                                /* Skip Default Col Value and Formula on HEADER ROW*/
                                if (modifyRowIndex > 0) {
                                    /* Add formula in columns if specified - Case : Edit Row*/


                                }
                            }
                        }
                    },
                    afterChange: function(changes, source) {
                        if (source == 'redo' || source == 'undo' || source == 'noaction') {
                            return false;
                        }


                        if (!changes) {
                            return;
                        }
                        if (renderState == false)
                            return false;

                        var pSsid = "5baf22088f7c443014cff18b-1-0-1_1";
                        var pName = $('#name-' + pSsid).val();
                        var pDesc = $('#desc-' + pSsid).val();
                        var pCid = $('#fileColId-49-476-1-0-1_1').val() || '';
                        var instance = this.getInstance();

                        if (pSsid == '')
                            return false;

                        if (pName != "") {

                            if (source == 'paste' || source == 'autofill' || multicellUpdate == true) {

                                var cellChangesHdr = [];
                                var cellChangesUpd = [];
                                var cellChangesNew = [];

                                if (source == 'paste' || source == 'autofill')
                                    action = "copyPaste";
                                else if (multicellUpdate == true) /* Case for updating multiple rows by 'Select'  */
                                    action = 'multiRowsUpdate';

                                var chLength = changes.length - 1;
                                var minVal = changes[0][0];
                                var maxVal = changes[chLength][0];

                                for (var modifyRowIndex = minVal; modifyRowIndex <= maxVal; modifyRowIndex++) {

                                    var changedRow = modifyRowIndex;
                                    if ($.inArray(changedRow, newRowsIndexs) > -1) {
                                        if (changedRow == 0) {
                                            rowData = instance.getDataAtRow(changedRow);
                                            rowData.splice(1, 0, "", "");
                                            cellChangesHdr = rowData;
                                        } else {
                                            rowData = instance.getDataAtRow(changedRow);
                                            /* Get Solved value - if formula enabled on columns*/


                                            rowData.splice(1, 0, "", "");
                                            cellChangesNew.push(rowData);
                                        }
                                    } else {
                                        if (changedRow == 0) {
                                            rowData = instance.getDataAtRow(changedRow);
                                            rowData.splice(1, 0, "", "");
                                            cellChangesHdr = rowData;
                                        } else {
                                            rowData = instance.getDataAtRow(changedRow);
                                            /* Get Solved value - if formula enabled on columns*/



                                            rowData.splice(1, 0, "", "");
                                            cellChangesUpd.push(rowData);
                                        }
                                    }

                                }

                                var rowId = this.getDataAtCell(changedRow, 0);
                                var data = JSON.stringify({
                                    'data': {
                                        ssid: pSsid,
                                        action: "copyPaste",
                                        name: pName,
                                        desc: pDesc,
                                        hdrrows: cellChangesHdr,
                                        updrows: cellChangesUpd,
                                        newrows: cellChangesNew,
                                        row_id: rowId
                                    }
                                });

                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + pCid.split("#")[0] + $app.queryString(),
                                    data: data
                                });
                                newRowsIndexs = [];
                                multicellUpdate = false;

                                /*  Trigger workflow if change is on single row*/
                                if ((cellChangesNew.length + cellChangesUpd.length) == 1) {
                                    if ((cellChangesNew.length) == 1) {
                                        var wrkFlwRow = cellChangesNew[0];
                                    } else if ((cellChangesUpd.length) == 1) {
                                        var wrkFlwRow = cellChangesUpd[0];
                                    }

                                    for (var pChnKy in changes) {
                                        var pChangedInfo = changes[pChnKy];
                                        var fCol = pChangedInfo[1];
                                        if (fCol in hot3Conf['49-476-1-0-1_1'].settingsColEventConf) {
                                            /*   Trigger Event*/
                                            var colIndex = parseInt(fCol) + 2;
                                            var colValue = wrkFlwRow[colIndex];
                                            var wrkFlwId = hot3Conf['49-476-1-0-1_1'].settingsColEventConf[colIndex - 2]['eventparameter'];
                                            var Rowjson = Array;
                                            var Row = {};
                                            var jsonData = Array;
                                            /* append the column name to the values pair*/
                                            Rowjson = {}
                                            $.each(wrkFlwRow, function(key, value) {
                                                if (key > 2) {
                                                    key = key - 2;
                                                    var RowKey = hot3Conf['49-476-1-0-1_1'].xdata[0][key];
                                                    Rowjson[RowKey] = value;
                                                }
                                            });
                                            Rowjson['rowID'] = rowId;
                                            jsonData = [Rowjson];
                                            Row = {
                                                ssid: pSsid,
                                                action: 'event',
                                                row_id: wrkFlwRow[0],
                                                rows: Rowjson,
                                                selectedValues: wrkFlwRow
                                            };
                                            $.ajax({
                                                type: "POST",
                                                dataType: "json",
                                                url: "/workflow.init/" + wrkFlwId + "/" + pCid + $app.queryString(),
                                                data: { "data": JSON.stringify(jsonData) },
                                                success: function(data) {
                                                    $(document).trigger("workflowInQuee", [{ data: data, id: wrkFlwId }]);
                                                    $.each(data.Actions['messages'], function(i, item) {
                                                        $app.setMessage(item, i);
                                                    });
                                                }
                                            });

                                        }
                                    }
                                }

                            } else {
                                /*  SpreadSheet Edit Mode*/
                                var changedRow = changes[0][0];
                                var colIndex = changes[0][1];
                                var colValue = changes[0][3];

                                /* Appplying Formaula
                                check if the col has formual with it */
                                if (colValue) {
                                    if (colValue[0] === '=') {
                                        colValue = formulaSolver(colValue, instance, changedRow, colIndex);

                                    }
                                }
                                /*  Ends Formula Check */

                                if (colIndex == 0) {
                                    return false; /* Skip on hidden fields (rowId) changes*/
                                }

                                if ($.inArray(changedRow, newRowsIndexs) > -1) {
                                    action = 'rowInsert';
                                } else {
                                    action = 'rowUpdate';
                                }

                                var rowId = this.getDataAtCell(changedRow, 0);
                                var rowData = this.getDataAtRow(changedRow);
                                rowData.splice(1, 0, "", "");
                                colIndex = parseInt(colIndex) + 2;
                                var savePath = "/ls/livespace/spreadsheet.save/" + pCid.split("#")[0] + $app.queryString();
                                var data = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        rows: rowData,
                                        ssid: pSsid,
                                        action: action,
                                        col_index: colIndex,
                                        col_value: colValue,
                                        row_id: rowId
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: savePath,
                                    data: data
                                });
                                newRowsIndexs = [];

                                /*  Trigger Event*/
                                if (colIndex - 2 in hot3Conf['49-476-1-0-1_1'].settingsColEventConf) {
                                    var wrkFlwId = hot3Conf['49-476-1-0-1_1'].settingsColEventConf[colIndex - 2]['eventparameter'];
                                    var Rowjson = Array;
                                    var Row = {};
                                    var jsonData = Array;
                                    /*  append the column name to the values pair*/
                                    Rowjson = {}
                                    $.each(rowData, function(key, value) {
                                        if (key > 2) {
                                            key = key - 2;
                                            var RowKey = hot3Conf['49-476-1-0-1_1'].xdata[0][key];
                                            Rowjson[RowKey] = value;
                                        }
                                    });
                                    Rowjson['rowID'] = rowId;
                                    jsonData = [Rowjson];
                                    Row = {
                                        ssid: pSsid,
                                        action: 'event',
                                        row_id: rowId,
                                        rows: Rowjson,
                                        selectedValues: rowData
                                    };
                                    $.ajax({
                                        type: "POST",
                                        dataType: "json",
                                        url: "/workflow.init/" + wrkFlwId + "/" + pCid + $app.queryString(),
                                        data: { "data": JSON.stringify(jsonData) },
                                        success: function(data) {
                                            $(document).trigger("workflowInQuee", [{ data: data, id: wrkFlwId }]);
                                            $.each(data.Actions['messages'], function(i, item) {
                                                $app.setMessage(item, i);
                                            });
                                        }
                                    });
                                }

                            }

                        } else {
                            if (changes != null) {

                            }
                        }
                    },
                    beforeKeyDown: function(e) {
                        /*   Check Key for remove row action*/
                        if (e.keyCode === 46) {
                            lastKeyCode = 'delete';
                        }
                    },

                    beforeRemoveRow: function(index, amount) {
                        var rowIndex = index;
                        var rowData;
                        var rowId = [];
                        var Dconfirm = confirm("do you want to delete the row.");

                        /* ## Get RowId of selected row */
                        if (Dconfirm == false) {
                            return false;
                        }

                        for (var i = 0; i < amount; i++) {
                            if (i > 0)
                                rowIndex = (rowIndex + 1);

                            rowData = this.getDataAtCell(rowIndex, 0);
                            rowId.push(rowData);
                        }

                        var pSsid = "5baf22088f7c443014cff18b-1-0-1_1";
                        var pName = $('#name-' + pSsid).val();

                        if (pSsid == '')
                            return false;

                        if (pName != "") {
                            var data = JSON.stringify({
                                'data': {
                                    ssid: pSsid,
                                    action: 'row_remove',
                                    row_id: rowId
                                }
                            });
                            $.ajax({
                                type: "POST",
                                dataType: 'json',
                                url: "/ls/livespace/spreadsheet.save/" + $app.queryString(),
                                data: data,
                                success: function() {
                                    var isRep;
                                    if ($('.container-fluid').hasClass('isLsSpreadSheet')) {
                                        isRep = $('.isLsSpreadSheet').find('#isReport').val();
                                    } else {
                                        isRep = $('.isLsSheet').find('#isReport').val();
                                    }

                                    if (isRep == '1') {
                                        var pGridViewEnabled = "";
                                        if (pGridViewEnabled == true) {} else
                                            fnApplyFilter();
                                        $(".filterByLiveapp").hide();
                                    } else {
                                        $(".previewTabSpread").trigger("shown.bs.tab");
                                    }
                                }
                            });
                        }

                    },
                    afterCreateRow: function(index, amount) {},
                    afterCreateCol: function(index, amount) {
                        var pSsid = "5baf22088f7c443014cff18b-1-0-1_1";
                        var pName = $('#name-' + pSsid).val();

                        if (pSsid == '')
                            return false;

                        if (pName != "") {

                            var data = JSON.stringify({
                                'data': {
                                    ssid: pSsid,
                                    action: 'column_insert',
                                    col_pos: index + 2
                                }
                            });
                            $.ajax({
                                type: "POST",
                                dataType: 'json',
                                url: "/ls/livespace/spreadsheet.save/" + $app.queryString(),
                                data: data
                            }).success(function(rdata) {

                                $('a.previewTabSpread').trigger('shown.bs.tab');

                            });

                        }

                    },
                    beforeRemoveCol: function(index, amount) {
                        return confirm("Are you sure you want to delete this column. Deleting columns might cause data loss.");
                    },
                    afterRemoveCol: function(index, amount) {
                        var pSsid = "5baf22088f7c443014cff18b-1-0-1_1";
                        var pName = $('#name-' + pSsid).val();

                        if (pSsid == '')
                            return false;

                        if (pName != "") {
                            var data = JSON.stringify({
                                'data': {
                                    ssid: pSsid,
                                    action: 'column_remove',
                                    col_pos: index + 2,
                                    num_of_columns: amount
                                }
                            });
                            $.ajax({
                                type: "POST",
                                dataType: 'json',
                                url: "/ls/livespace/spreadsheet.save/" + $app.queryString(),
                                data: data
                            }).success(function(rdata) {
                                $('a.previewTabSpread').trigger('shown.bs.tab');
                            });

                        }

                    }


                };


                function formulaSolver(colValue, instance, changedRow, colIndex) {
                    formula = colValue.substr(1).toUpperCase();

                    var cellId = instance.plugin.utils.translateCellCoords({
                        row: changedRow,
                        col: colIndex
                    })

                    var newValue = instance.plugin.parse(formula, {
                        row: changedRow,
                        col: colIndex,
                        id: cellId
                    });
                    error = newValue.error;
                    result = newValue.result;
                    if (error) {
                        /* clear cell value*/
                        if (!colValue) {
                            /*  reset error*/
                            error = null;
                        } else {
                            /*  show error*/
                            colValue = error;
                        }
                    } else {
                        colValue = result;
                    }

                    return colValue;

                };

                function generateTags(coords, TagrowID, DataAtCell, clolumnListArray, generalSettings, tagInstance) {
                    var Tagname = '';
                    var tagData = null;
                    for (var i in clolumnListArray) {
                        var cTagindex = clolumnListArray[i];
                        tagData = DataAtCell(coords.row, cTagindex);
                        if (tagData != null && $.trim(tagData)) {
                            tagData = $.trim($('<p> ' + tagData.toString() + ' </p>').text());
                            tagData = tagData.replace(/ /g, "_");
                            tagData = tagData.slice(0, 40);
                            if (tagData[0] === '=')
                                tagData = formulaSolver(tagData, tagInstance, coords.row, cTagindex);
                            Tagname = Tagname + ' ' + tagData;
                        }
                    }
                    if (Tagname != '' && $.trim(Tagname)) {
                        Tagname = Tagname.replace(/\//g, '_vSv_');
                        Tagname = Tagname.replace(/\#/g, '__vizHash__');
                        Tagname = Tagname.replace(/\%/g, '__vizPercent__');

                        var setUrl = window.location.pathname + $app.queryString();
                        if (window.location.toString().indexOf("#") != -1) {
                            setUrl = window.location.toString().split('#')[1];
                            setUrl = setUrl.split('?')[0];
                        }

                        if (setUrl.indexOf("rowId") >= 0 && setUrl.indexOf("ssId") >= 0) {
                            var tmpUrlSeg = setUrl.split("/rowId/");
                            setUrl = tmpUrlSeg[0];
                        }

                        var appId = $('#appsId').val();
                        var lsId = $('#uId').val() + '-' + $('#portalId').val();
                        var setngsssid = "5baf22088f7c443014cff18b-1-0-1_1";
                        setngsssid = setngsssid.split('-')[0];
                        setUrl = setUrl + '/rowId/' + TagrowID + '/ssId/' + setngsssid + '/' + encodeURIComponent(Tagname) + $app.queryString();

                        $.fn.addBcastTag({
                            tag: Tagname,
                            url: setUrl,
                            ssid: setngsssid,
                            rowid: TagrowID,
                            appid: appId,
                            lsid: lsId,
                            type: 'spreadsheet'
                        });
                    }

                };


                /* Update Settings*/
                hot3['49-476-1-0-1_1'] = new Handsontable(container, sheetnew);
                hot3Id = '49-476-1-0-1_1';
                lapSS.push('49-476-1-0-1_1');
                /*  give a message if spreadsheet not saved after entering title..*/
                $('.5413ce4de4e87a933ea2b6d059c3675f').on('keypress, change', 'input.spreadsheet', function(event) {
                    if (event.keyCode == 13 || event.keyCode == 9 || event.type == "change") {
                        var pSsid = "5baf22088f7c443014cff18b-1-0-1_1";
                        var pName = $('#name-' + pSsid).val();
                        var pDesc = $('#desc-' + pSsid).val();
                        var fileColId = $('#fileColId-49-476-1-0-1_1').val() || $('.isLsSpreadSheet').find($('[name="fileColId"]')).val();
                        if (pName != "" && $('a.spreadsheet').hasClass('saved') == false && pSsid == "") {
                            /*  Not saved*/
                            $app.setMessage("Please save spreadsheet", "warn");
                            return false;
                        }
                    }
                    if (pName != "" && pSsid != "") {

                        var tmpCntKey = $("#cntId").attr('data-cntKey');

                        /* SS Update meta*/
                        var data = JSON.stringify({
                            'data': {
                                name: pName,
                                desc: pDesc,
                                ssid: pSsid,
                                action: 'metaDataUpdate'
                            }
                        });
                        $.ajax({
                            type: "POST",
                            dataType: 'json',
                            url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                            data: data,
                            success: function(data) {
                                if (data.Result.message != null && data.Result.status == "failed") {
                                    $app.setMessage(data.Result.message, 'error');
                                }
                            }
                        });

                    }


                });


                $('.5413ce4de4e87a933ea2b6d059c3675f a.spreadsheet').on('click', function(event) {
                    var pSsid = "5baf22088f7c443014cff18b-1-0-1_1";
                    var pName = $('#name-' + pSsid).val();
                    var pDesc = $('#desc-' + pSsid).val();
                    var fileColId = $('#fileColId-49-476-1-0-1_1').val() || "";
                    var tempRows = jQuery.extend(true, {}, hot3Conf['49-476-1-0-1_1'].SPdata);
                    if (tempRows[0][0] == "" || tempRows[0][0] == null) {
                        var i = Math.random();
                        var xrowId = $app.md5(xtid + xuid + "'" + $.now() + i + "'");
                        hot3['49-476-1-0-1_1'].setDataAtCell(0, 0, xrowId, 'insert');
                    }

                    if (pName != "") {
                        if ($(this).hasClass('saved') == false) {
                            /*    New SS insert */
                            if (pSsid == '') {
                                tempRows = jQuery.extend(true, {}, hot3Conf['49-476-1-0-1_1'].SPdata);
                                var pChangedRow = [];
                                $.each(tempRows, function(index, tRow) {
                                    if (tRow[0] != "" && tRow[0] != null) {
                                        tRow.splice(1, 0, "", "");
                                        pChangedRow.push(tRow);
                                    }
                                });

                                var pdata = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        rows: pChangedRow,
                                        ssid: pSsid,
                                        action: 'metaDataInsert'
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                                    data: pdata
                                }).success(function(rdata) {
                                    if ($('#ssid').val() == "") {
                                        if (rdata.Result.status == "success") {
                                            $('a.spreadsheet').remove();
                                            if (isRep == 'r') {
                                                $('button.spsheetsavebut').removeClass('hide');
                                            }
                                            $('#ssid').val(rdata.Result.sid.$id);
                                            var fileId = rdata.Result.colFileOwner;
                                            var fIdArray = fileId.split('-');
                                            var fid = fIdArray[1] + '-' + fIdArray[0] + '-' + fIdArray[2];
                                            $('input[name="fileColId"]').attr('id', 'fileColId-' + $('#ssid').val());
                                            $('input[name="name"]').attr('id', 'name-' + $('#ssid').val());
                                            $('input[name="desc"]').attr('id', 'desc-' + $('#ssid').val());
                                            $('#fileColId-' + $('#ssid').val()).val(fid);

                                            $app.setMessage(rdata.Result.message, "success");
                                        } else if (rdata.Result.status == "failed") {
                                            $app.setMessage(rdata.Result.message, "danger");
                                        }

                                    }

                                });

                            } else {
                                /* SS Update meta*/
                                var data = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        ssid: pSsid,
                                        action: 'metaDataUpdate'
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                                    data: data
                                });
                            }
                        }
                    } else {
                        $app.setMessage("Please enter title", "warn");
                    }
                    return false;

                });

                $('.5413ce4de4e87a933ea2b6d059c3675f button.closeModal').on('click', function() {
                    $('div.modal-header .close').trigger('click');
                });


                /* Save action for report*/
                $('.5413ce4de4e87a933ea2b6d059c3675f button.spsheetsavebut').on('click', function() {
                    var cntId;
                    if ($('.container-fluid').hasClass('isLsSpreadSheet')) {
                        cntId = $('.isLsSpreadSheet').find('#cntId').val();
                    } else {
                        cntId = $('.isLsSheet').find('#cntId').val();
                    }
                    if (isRep == 'r') {
                        /*  Add new ss inside dashboard widget*/
                        var pSsid = "5baf22088f7c443014cff18b-1-0-1_1";
                        var pName = $('#name-' + pSsid).val();
                        var pDesc = $('#desc-' + pSsid).val();
                        var fileColId = $('#fileColId-49-476-1-0-1_1').val() || '';
                        if ($("#isAdded").val() == '') {
                            var title = pName;
                            if (pSsid == '') {
                                var tempRows = jQuery.extend(true, {}, hot3Conf['49-476-1-0-1_1'].SPdata);
                                var pChangedRow = [];
                                $.each(tempRows, function(index, tRow) {
                                    if (tRow[0] != "" && tRow[0] != null) {
                                        tRow.splice(1, 0, "", "");
                                        pChangedRow.push(tRow);
                                    }
                                });

                                var pdata = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        rows: pChangedRow,
                                        ssid: pSsid,
                                        action: 'metaDataInsert'
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                                    data: pdata
                                }).success(function(rdata) {
                                    if ($('#ssid').val() == "") {
                                        if (rdata.Result.status == "success") {
                                            $('a.spreadsheet').addClass("saved");
                                            $('#ssid').val(rdata.Result.sid.$id);
                                            var fileId = rdata.Result.colFileOwner;
                                            var fIdArray = fileId.split('-');

                                            var fid = fIdArray[1] + '#' + fIdArray[2] + '-' + cntId;
                                            $('#fileColId-' + $('#ssid').val()).val(fid);
                                            var wid = fIdArray[1] + '#' + fIdArray[2] + '-' + cntId;
                                            /*  For thumbnail*/
                                            var thumbnail = '/ui-themes/karma/images/svg/spreadsheet.svg';
                                            var templte = '<li><input type="checkbox" name="chk_files[]" id="chk_files_' + fid + '" class=" hide flo mr5 add-to-list" value="' + fid + '">';
                                            templte += '<div><input  name="widget[]" type="hidden" value="' + wid + '"/>';
                                            templte += ' <span class="drag ActionIcon label pull-right"><a  class=" mr10" title="Delete"><i class="fa fa-trash element-remove" title="Delete"></i></a></span> ';
                                            templte += ' <img width="20" height="20" border="0" class="flo ml10mr10" src="' + thumbnail + '"><span class="' + fid + '">' + title + '</span>';
                                            templte += '</div>';
                                            templte += '</li>';
                                            dataSet = {
                                                id: fid,
                                                title: title
                                            }
                                            console.log($('#ssid').val(rdata.Result.sid.$id));
                                            eTemplate = `<div class="actionItems"> 
                        <a><i class="fa fa-edit"></i></a><a><i class="fa fa-trash"></i></a>
                        <span class"oname">${dataSet.title}</span> 
                       </div>`;
                                            $('.tab-pane.active').find('.gs-w.active .objectAction').html($(eTemplate).data(dataSet));
                                            $("#isAdded").val('added');
                                            $(this).html('Update');
                                            $('.code-save-btn-app').trigger('click');
                                            $('div.modal-header .close').trigger('click');
                                        } else if (rdata.Result.status == "failed") {
                                            $app.setMessage(rdata.Result.message, "danger");
                                            return false;
                                        }
                                    }
                                });
                            } else {
                                /* Edit dashboard in Add excel case*/
                                var fileColId = $('#fileColId-' + pSsid).val();
                                var fIdArray = fileColId.split('-');
                                var fid = fIdArray[0] + '-' + fIdArray[2] + '-' + cntId;
                                var wid = fIdArray[0] + '#' + fIdArray[2] + '-' + cntId;
                                /*For thumbnail*/
                                var thumbnail = '/ui-themes/karma/images/svg/spreadsheet.svg';
                                var templte = '<li><input type="checkbox" name="chk_files[]" id="chk_files_' + fid + '" class=" hide flo mr5 add-to-list" value="' + fid + '">';
                                templte += '<div><input  name="widget[]" type="hidden" value="' + wid + '"/>';
                                templte += ' <span class="drag font_20 label pull-right">  <i  TITLE="Delete" class="icon-trash element-remove"></i> </span> ';
                                templte += ' <img width="20" height="20" border="0" class="flo mr10" src="' + thumbnail + '"><span class="' + fid + '">' + title + '</span>';
                                templte += '</div>';
                                templte += '</li>';
                                dataSet = {
                                    id: wid,
                                    title: title
                                }

                                console.log($('#ssid').val());
                                eTemplate = `<div class="actionItems"> 
                        <a><i class="fa fa-edit"></i></a><a><i class="fa fa-trash"></i></a>
                       </div>`;
                                $('.tab-pane.active').find('.gs-w.active .objectAction').html($(eTemplate).data(dataSet));
                                $('.tab-pane.active').find('.gs-w.active .tName').html(`<span class"oname">${dataSet.title}</span>`);
                                $('.tab-pane.active').find('.gs-w.active').data('id', dataSet.id);

                                $("#isAdded").val('added');
                                $('.code-save-btn-app').trigger('click');
                                $('div.modal-header .close').trigger('click');

                            }
                        } else {
                            /* Update SS title if change title from the dashboard edit*/
                            if (pSsid != '' && $("#isAdded").val() != '' && pName != "") {
                                /* Update SS title if change title from the dashboard edit
                                 SS Update meta*/

                                var title = pName;
                                var fileColId = $('#fileColId-' + pSsid).val();
                                var fIdArray = fileColId.split('-');

                                var fid = fIdArray[0] + '-' + fIdArray[2];
                                var data = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        ssid: pSsid,
                                        action: 'metaDataUpdate'
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                                    data: data
                                });

                                $('.code-drop-region-app.active').find('span[class^=' + fid + ']').html(title);
                                /*     var widgetVal   = $('.code-drop-region-app.active').find('span[class^='+fid+']').closest('li>div').find('input[type=hidden]').val();
                                     if(widgetVal.indexOf('#VIZEFLAG')==-1)
                                       $('.code-drop-region-app.active').find('span[class^='+fid+']').closest('li>div').find('input[type=hidden]').val(widgetVal+"#VIZEFLAG");*/
                                $('.code-save-btn-app').trigger('click');
                                $('div.modal-header .close').trigger('click');
                            }

                        }


                    }
                    $("#isAdded").val('');
                    // $('#fileColId-49-476-1-0-1_1').val('');
                    $('#ssid').val('');
                });


                hot3['49-476-1-0-1_1'].render();
                setTimeout(function() { hot3['49-476-1-0-1_1'].render(); }, 1000);

                /* Validate all cells afterLoad*/
                var setngsssid = '49-476-1-0-1_1';
                var selectedColumnIndex = 1;
                var selectedColumn = ''; //get value after updating columnsettings only
                if (setngsssid == '') {
                    setngsssid = 0;
                }



                /*  $( "#ShowBroadcast" ).click(function() {
                    $('.ssarea').addClass('ssclass');
                    $('#rightPanSettings').hide();
                    
                  });*/

                $(".sidebar-close").click(function() {
                    $('.ssarea').removeClass('ssclass');
                    $('#rightPanSettings').show();
                    setTimeout(function() { hot3['49-476-1-0-1_1'].render(); }, 300);
                });

                $(".sidebar-close").click(function() {
                    setTimeout(function() { hot3['49-476-1-0-1_1'].render(); }, 300);
                });

                /* text Search on spreadsheet */
                $('.5413ce4de4e87a933ea2b6d059c3675f').on('keypress', '.ss-text-search', function(e) {
                    var key = e.which;
                    if (key == 13) {
                        var searchBtn = $(this).parent().find('.ss-text-search-btn');
                        searchBtn.trigger('click');
                        return false;
                    }
                });


                $('#sheet-49-476-1-0-1_1 .ht_master .wtHolder').ssAutoPaginate()



                xtid = "11";
                xuid = "lucas@vizru.com";
                hot3Conf['49-479-1-0-6_1'] = {
                    SPdata: [
                        ["0761986cb2bdc0d81ec742019179c3ac", "UUID", "CRID", "UID", "Template", "Document ID", "Policy ID", "ClientID", "ClientName", "ClientFullName", "Carrier ID", "Contract Type", "Primary Insured", "Insured ID", "Secondary Insured", "Age", "Gender", "Smoker", "State", "UnderwriterClass", "Household", "Premium Mode", "Premium Design", "Premium Duration", "Purpose", "Policy Date", "Carrier Name", "Owner Beneficiary Name", "SM_InsuredName", "Risk Level", "PII", "PCI", "MemberFirm", "SourceFile", "VerifyStatus", "VerifyButton", "TemplateStatus", "AuditLog", "SelectBox", "checkbox_selected", "LogReviewStatus", "prev_scanned", "Initial Planned Premium", "Total Premium Paid to Date", "Cash Surrender Value", "DeathBenefit", "ScannedStatus", "DataSource"]
                    ],
                    xdata: [
                        ["0761986cb2bdc0d81ec742019179c3ac", "UUID", "CRID", "UID", "Template", "Document ID", "Policy ID", "ClientID", "ClientName", "ClientFullName", "Carrier ID", "Contract Type", "Primary Insured", "Insured ID", "Secondary Insured", "Age", "Gender", "Smoker", "State", "UnderwriterClass", "Household", "Premium Mode", "Premium Design", "Premium Duration", "Purpose", "Policy Date", "Carrier Name", "Owner Beneficiary Name", "SM_InsuredName", "Risk Level", "PII", "PCI", "MemberFirm", "SourceFile", "VerifyStatus", "VerifyButton", "TemplateStatus", "AuditLog", "SelectBox", "checkbox_selected", "LogReviewStatus", "prev_scanned", "Initial Planned Premium", "Total Premium Paid to Date", "Cash Surrender Value", "DeathBenefit", "ScannedStatus", "DataSource"]
                    ],
                    settingsConf: { "4": "dropdown", "20": "dropdown", "31": "datatype", "30": "datatype", "35": "datatype", "37": "datatype", "36": "datatype", "34": "datatype", "38": "datatype", "39": "datatype", "40": "dropdown", "13": "datatype", "42": "datatype", "43": "datatype", "44": "datatype", "45": "datatype", "41": "datatype" },

                    settingsConfType: { "4": ["Simple Policy Inventory", "Complex Policy Inventory"], "20": [""], "31": "numeric", "30": "numeric", "35": "html", "37": "html", "36": "numeric", "34": "numeric", "38": "html", "39": "numeric", "40": ["Rejected", "Corrected", "Accepted", ""], "13": "numeric", "42": "numeric", "43": "numeric", "44": "numeric", "45": "numeric", "41": "numeric" },

                    settingsConfFormat: { "4": null, "20": null, "31": "", "30": "", "35": "", "37": "", "36": "", "34": "", "38": "", "39": "", "40": null, "13": "", "42": "", "43": "", "44": "", "45": "", "41": "" },

                    settingsColEventConf: { "4": { "eventtype": "onChange", "eventparameter": "5b866e401216628e40b0b893" } },

                    settingsColumnValidateConf: [],

                    settingsColumnLinkConf: [],

                    settingsReadOnlyColConf: [],

                    settingsDefColValueConf: [],

                    settingsColFormulaConf: [],
                    generalSettings: { "rowsize": 30, "lockHeader": false, "lockColumnOperation": false, "pagination": true, "pageSize": 30, "totalrecordcount": 0 }


                }

                generalSettings = { "rowsize": 30, "lockHeader": false, "lockColumnOperation": false, "pagination": true, "pageSize": 30, "totalrecordcount": 0 };

                if (hot3Conf['49-479-1-0-6_1'].generalSettings.mincolwidth !== undefined) {
                    var mincolWidths = hot3Conf['49-479-1-0-6_1'].generalSettings.mincolwidth;
                } else {
                    var mincolWidths = 150;
                }

                /*Cal pagination*/
                if (hot3Conf['49-479-1-0-6_1'].generalSettings.pagination == true) {
                    buildSSpagination(
                        hot3Conf['49-479-1-0-6_1'].generalSettings.totalrecordcount,
                        hot3Conf['49-479-1-0-6_1'].generalSettings.pageSize,
                        "sheet-49-479-1-0-6_1",
                        (hot3Conf['49-479-1-0-6_1'].SPdata.length - 1)
                    );
                }


                var renderState = false;
                var validationOnLoadStatus = false;

                var pSpredId = "49-479-1-0-6_1";
                var container = document.getElementById('sheet-' + pSpredId);

                var colsToHide = [0];

                function getCustomRenderer() {
                    return function(instance, td, row, col, prop, value, cellProperties) {
                        if (colsToHide.indexOf(col) > -1) {
                            cellProperties.copyable = false;
                            cellProperties.colWidths = 1;
                        }
                        Handsontable.renderers.TextRenderer.apply(this, arguments);
                    }
                }
                var yellowRenderer = function(instance, td, row, col, prop, value, cellProperties) {
                    td.style.backgroundColor = 'yellow';
                    return td;
                };

                /*Custom edit function for LINK type column*/
                var LinkEditor = Handsontable.editors.TextEditor.prototype.extend();

                LinkEditor.prototype.getValue = function() {
                    if (this.col in hot3Conf['49-479-1-0-6_1'].settingsColumnLinkConf) {
                        return '<a class=" ajax vizLSSSLink" data-width="90%" title="Detail View" href="/ls/livespace/spreadsheet.sslink/' + hot3Conf['49-479-1-0-6_1'].settingsColumnLinkConf[this.col][0]['obj-id'] + '/' + hot3Conf['49-479-1-0-6_1'].settingsColumnLinkConf[this.col][0]['linkto'] + '/' + this.TEXTAREA.value + '" >' + this.TEXTAREA.value + '</a>';
                    } else {
                        return '<a  >' + this.TEXTAREA.value + '</a>';
                    }
                };

                LinkEditor.prototype.setValue = function(newValue) {
                    var regex = /(<([^>]+)>)/ig
                    var modiValue = newValue.replace(regex, "");
                    this.TEXTAREA.value = modiValue;
                };

                var coldef = [];
                var cellChanges = [];
                var newRowsIndexs = [];
                var multicellUpdate = false;

                function rowCalc() {
                    var rval;
                    var rowCalcValve = ((parseInt(generalSettings.rowsize) + (7 / parseInt(generalSettings.rowsize))) * 23.765) - 5 + (1 / parseInt(generalSettings.rowsize));
                    var wHeight = ($(window).height() - 200);
                    if (rowCalcValve >= wHeight) { rval = wHeight } else { rval = rowCalcValve; }
                    return rval;
                };
                /* Dynamic Column Validation function creation*/


                function functionCellValidator(spid, colIndex, colValue) {
                    if (hot3Conf[spid].settingsColumnLinkConf[colIndex]) {
                        colValue = $(colValue).text();
                    }
                    var result = true;
                    var colValidConf = hot3Conf[spid].settingsColumnValidateConf[colIndex];
                    $.each(colValidConf, function(vType, vConf) {
                        switch (vType) {
                            case 'numeric_validation':
                                if ('min_value' in vConf && 'max_value' in vConf) {
                                    if (colValue < vConf['min_value'] || colValue > vConf['max_value']) {
                                        result = false;
                                    }
                                } else if ('min_value' in vConf) {
                                    if (colValue < vConf['min_value']) {
                                        result = false;
                                    }
                                } else if ('max_value' in vConf) {
                                    if (colValue > vConf['max_value']) {
                                        result = false;
                                    }
                                }

                                if (result == true) {
                                    if ('char_length_min' in vConf && 'char_length_max' in vConf) {
                                        if (colValue.toString().length < vConf['char_length_min'] || colValue.toString().length > vConf['char_length_max']) {
                                            result = false;
                                        }
                                    } else if ('char_length_min' in vConf) {
                                        if (colValue.toString().length < vConf['char_length_min']) {
                                            result = false;
                                        }
                                    } else if ('char_length_max' in vConf) {
                                        if (colValue.toString().length > vConf['char_length_max']) {
                                            result = false;
                                        }
                                    }
                                }
                                break;

                            case 'text_validation':
                                if (colValue == undefined) {
                                    colValue = '';
                                }
                                if ('in_list' in vConf) {
                                    if (jQuery.inArray(colValue.toLowerCase(), vConf['in_list']) < 0) {
                                        result = false;
                                    }
                                } else if ('notin_list' in vConf) {
                                    if (jQuery.inArray(colValue.toLowerCase(), vConf['notin_list']) > -1) {
                                        result = false;
                                    }
                                }

                                if (result == true) {
                                    if ('char_length_min' in vConf && 'char_length_max' in vConf) {
                                        if (colValue.toString().length < vConf['char_length_min'] || colValue.toString().length > vConf['char_length_max']) {
                                            result = false;
                                        }
                                    } else if ('char_length_min' in vConf) {
                                        if (colValue.toString().length < vConf['char_length_min']) {
                                            result = false;
                                        }
                                    } else if ('char_length_max' in vConf) {
                                        if (colValue.toString().length > vConf['char_length_max']) {
                                            result = false;
                                        }
                                    }
                                }
                                break;
                            case 'date_validation':
                                var columnDtFormat = 'MM/DD/YYYY';
                                if (colIndex in hot3Conf[spid].settingsConfFormat) {
                                    columnDtFormat = hot3Conf[spid].settingsConfFormat[colIndex];
                                }
                                if (columnDtFormat == '') {
                                    columnDtFormat = 'MM/DD/YYYY';
                                }
                                var tmpColValue = moment(colValue, columnDtFormat);
                                if (tmpColValue == undefined || !tmpColValue.isValid()) {
                                    result = false;
                                } else {
                                    var tmpColValue = tmpColValue.format('YYYY-MM-DD');
                                    if ('min_date' in vConf && 'max_date' in vConf) {
                                        var min_dt = moment(vConf['min_date']).format('YYYY-MM-DD');
                                        var max_dt = moment(vConf['max_date']).format('YYYY-MM-DD');
                                        if (tmpColValue < min_dt || tmpColValue > max_dt) {
                                            result = false;
                                        }
                                    } else if ('min_date' in vConf) {
                                        var min_dt = moment(vConf['min_date']).format('YYYY-MM-DD');
                                        if (tmpColValue < min_dt) {
                                            result = false;
                                        }
                                    } else if ('max_date' in vConf) {
                                        var max_dt = moment(vConf['max_date']).format('YYYY-MM-DD');
                                        if (tmpColValue > max_dt) {
                                            result = false;
                                        }
                                    }

                                }
                                break;
                        }
                    });
                    return result;
                }

                function customDateValidator(value, callback) {
                    if (!value && this.allowEmpty) {
                        callback(true);
                    } else {
                        Handsontable.DateValidator.call(this, value, callback);
                    }
                }

                function customDropdownValidator(value, callback) {
                    if (!value && this.allowEmpty) {
                        callback(true);
                    } else {
                        Handsontable.AutocompleteValidator.call(this, value, callback);
                    }
                }
                if (hot3Conf['49-479-1-0-6_1'].generalSettings.fixedColumnCheck == true) {
                    var fixedColumn_key = hot3Conf['49-479-1-0-6_1'].generalSettings.fixedColumn_key;
                } else {
                    var fixedColumn_key = false;
                }
                var sheetnew = {
                    data: hot3Conf['49-479-1-0-6_1'].SPdata,
                    height: 315,
                    minCols: 10,

                    minRows: hot3Conf['49-479-1-0-6_1'].generalSettings.pageSize,


                    minSpareRows: 5,
                    rowHeights: 35,
                    visibleRows: 8,
                    colHeaders: true,
                    rowHeaders: true,
                    stretchH: 'all',
                    autoColumnSize: true,
                    manualColumnResize: true,
                    outsideClickDeselects: false,
                    colWidths: mincolWidths,
                    columnSorting: false,
                    formulas: true,
                    fixedRowsTop: 1,
                    fixedColumnsLeft: fixedColumn_key + 1,
                    contextMenu: {
                        callback: function(key, options) {
                            if (key === 'rowhistory') {
                                handsontableRowHistory();
                            }
                            if (key === 'rowview') {
                                var obj_id = "49-479-1-0-6_1";
                                var ssid_str = "5b7275978b586b93007b2416-1-0-6_1";

                                handsontableRowView(obj_id, ssid_str);
                            }
                            if (key === 'tagview') {



                                var instance = this.getInstance();
                                var colIndexlist = instance.countCols();
                                var colIndexlistArray = [];
                                for (i = 1; i <= colIndexlist; i++)
                                    colIndexlistArray[i] = i;
                                rightBarFn().open("messages");
                                generateTags(options.start, this.getDataAtCell(options.start.row, 0), this.getDataAtCell, colIndexlistArray, hot3Conf['49-479-1-0-6_1'].generalSettings, instance);


                            }
                        },
                        items: {


                            "rowview": {
                                name: 'Row Detailed View',
                                disabled: function() {
                                    /* Disable for first row */
                                    return (hot3['49-479-1-0-6_1'].getSelected()[0] === 0);
                                }
                            },
                            "tagview": {
                                name: 'Tag to message',
                                disabled: function() {
                                    return (hot3['49-479-1-0-6_1'].getSelected()[0] === 0);
                                }
                            },
                            "remove_row": {
                                disabled: function() {
                                    /*if first row, disable this option*/
                                    return (hot3['49-479-1-0-6_1'].getSelected()[0] === 0)
                                }
                            }


                        }
                    },
                    cells: function(row, col, prop) {
                        var cellProperties = {};
                        if (_.indexOf(Object.keys(hot3Conf), '49-479-1-0-6_1') !== -1) {
                            if (col === 0) {
                                cellProperties.copyable = false;
                                cellProperties.colWidths = 1;
                                cellProperties.readOnly = true;
                            }
                            if (row == 0 && hot3Conf['49-479-1-0-6_1'].generalSettings.lockHeader == true) {
                                cellProperties.readOnly = true;
                            }





                            if (row != 0 && col in hot3Conf['49-479-1-0-6_1'].settingsConf) {
                                if (hot3Conf['49-479-1-0-6_1'].settingsConf[col] == "dropdown") {
                                    cellProperties.type = 'dropdown';
                                    cellProperties.source = hot3Conf['49-479-1-0-6_1'].settingsConfType[col];
                                    cellProperties.allowEmpty = true;
                                    cellProperties.validator = customDropdownValidator;
                                } else if (hot3Conf['49-479-1-0-6_1'].settingsConf[col] == "datatype") {

                                    if (hot3Conf['49-479-1-0-6_1'].settingsConfType[col] == 'date') {
                                        cellProperties.type = hot3Conf['49-479-1-0-6_1'].settingsConfType[col];
                                        cellProperties.dateFormat = hot3Conf['49-479-1-0-6_1'].settingsConfFormat[col];
                                        cellProperties.allowEmpty = true;
                                        cellProperties.validator = customDateValidator;
                                    } else if (hot3Conf['49-479-1-0-6_1'].settingsConfType[col] == 'datetime') {
                                        cellProperties.type = 'text';
                                        cellProperties.allowEmpty = true;
                                    } else if (hot3Conf['49-479-1-0-6_1'].settingsConfType[col] == 'html') {
                                        cellProperties.renderer = 'html';
                                    } else if (hot3Conf['49-479-1-0-6_1'].settingsConfType[col] == 'status') {
                                        //do nothing
                                    } else if (hot3Conf['49-479-1-0-6_1'].settingsConfType[col] == 'file') {
                                        cellProperties.copyable = false;
                                        cellProperties.readOnly = true;
                                    } else {
                                        cellProperties.type = hot3Conf['49-479-1-0-6_1'].settingsConfType[col];
                                        cellProperties.format = hot3Conf['49-479-1-0-6_1'].settingsConfFormat[col];
                                    }
                                    /* Disable normal numeric validator which col have custom validation */
                                } else if (hot3Conf['49-479-1-0-6_1'].settingsConf[col] == "columnlink" || hot3Conf['49-479-1-0-6_1'].settingsConf[col] == "dnalink") {
                                    cellProperties.renderer = 'html';
                                    cellProperties.editor = LinkEditor;

                                }

                            }






                            if (col in hot3Conf['49-479-1-0-6_1'].settingsColumnValidateConf && row > 0) {
                                var tmpCName = 'funcv_' + col + '_49-479-1-0-6_1';
                                var tmpFname = validateColumnFunctionObj[tmpCName];
                                cellProperties.validator = tmpFname;
                            }




                            if (hot3Conf['49-479-1-0-6_1'].settingsReadOnlyColConf.indexOf(col) != -1) {
                                cellProperties.readOnly = true;
                            }

                            if (col in hot3Conf['49-479-1-0-6_1'].settingsColFormulaConf && row > 0) {
                                cellProperties.readOnly = true;
                                cellProperties.copyable = false;
                            }





                        }
                        return cellProperties;
                    },
                    afterInit: function() {
                        renderState = true;
                    },

                    afterOnCellMouseDown: function(event, coords, TD) {





                        var instance = this.getInstance();
                        var rowCount = instance.countRows();
                        if (coords.row > (rowCount - 5)) {
                            if (hot3Conf['49-479-1-0-6_1'].settingsConf[coords.col] == "dropdown") {
                                $('.handsontableInputHolder').addClass('bottom');
                            }
                        } else {
                            $('.handsontableInputHolder').removeClass('bottom');
                        }
                    },

                    beforeChange: function(changes, source) {

                        /* No further actions, if the value is not changed*/

                        if (source == 'edit' && changes.length == 1 && changes[0][2] == changes[0][3]) {
                            changes = null;
                            source = 'noaction';
                            return false;
                        }

                        var selectedRange = this.getSelected();
                        if (lastKeyCode == "delete" && selectedRange[1] == 0) {

                            var selectRange = (selectedRange[2] - selectedRange[0]) + 1;

                            hot3['49-479-1-0-6_1'].alter('remove_row', selectedRange[0], selectRange);
                            hot3['49-479-1-0-6_1'].render();

                            changes = null;
                            source = 'delete';
                            lastKeyCode = '';
                            return false;

                        }

                        var instance = this.getInstance();
                        newRowsIndexs = []; /* array for store newly added rows index */
                        if (source == 'redo' || source == 'undo') {
                            return false;
                        }
                        if (changes.length > 1) {
                            multicellUpdate = true;
                        }
                        if (source == 'paste' || source == 'autofill' || multicellUpdate == true) {
                            var chLength = changes.length - 1;
                            var minRowIdx = changes[0][0];
                            var maxRowIdx = changes[chLength][0];

                            for (var modifyRowIndex = minRowIdx; modifyRowIndex <= maxRowIdx; modifyRowIndex++) {
                                var rowId = instance.getDataAtCell(modifyRowIndex, 0);

                                if (rowId == "" || rowId == null) {
                                    var i = Math.random();
                                    var xrowId = $app.md5(xtid + xuid + "'" + $.now() + i + "'");
                                    rowId = xrowId;
                                    changes.push([modifyRowIndex, 0, null, rowId]);

                                    /*Skip Default Col Value and Formula on HEADER ROW*/
                                    if (modifyRowIndex > 0) {
                                        for (var dCol in hot3Conf['49-479-1-0-6_1'].settingsDefColValueConf) {
                                            changes.push([modifyRowIndex, dCol, null, hot3Conf['49-479-1-0-6_1'].settingsDefColValueConf[dCol]]);
                                        }
                                        /* Add formula in columns if specified - Case : New Row*/


                                    }

                                    newRowsIndexs.push(modifyRowIndex);
                                }
                            }
                        } else {
                            var modifyRowIndex = changes[0][0];
                            var colIndex = changes[0][1];

                            if (colIndex == 0 && source != 'insert') {
                                return false; /* Skip on hidden fields (rowId) changes*/
                            }

                            var rowId = instance.getDataAtCell(modifyRowIndex, 0);

                            if (rowId == "" || rowId == null) {
                                var i = Math.random();
                                var xrowId = $app.md5(xtid + xuid + "'" + $.now() + i + "'");
                                rowId = xrowId;
                                changes.push([modifyRowIndex, 0, null, rowId]);

                                /*    Skip Default Col Value and Formula on HEADER ROW*/
                                if (modifyRowIndex > 0) {
                                    for (var dCol in hot3Conf['49-479-1-0-6_1'].settingsDefColValueConf) {
                                        changes.push([modifyRowIndex, dCol, null, hot3Conf['49-479-1-0-6_1'].settingsDefColValueConf[dCol]]);
                                    }
                                    /*  Add formula in columns if specified - Case : New Row*/


                                }

                                newRowsIndexs.push(modifyRowIndex);
                            } else {
                                /* Skip Default Col Value and Formula on HEADER ROW*/
                                if (modifyRowIndex > 0) {
                                    /* Add formula in columns if specified - Case : Edit Row*/


                                }
                            }
                        }
                    },
                    afterChange: function(changes, source) {
                        if (source == 'redo' || source == 'undo' || source == 'noaction') {
                            return false;
                        }


                        if (!changes) {
                            return;
                        }
                        if (renderState == false)
                            return false;

                        var pSsid = "5b7275978b586b93007b2416-1-0-6_1";
                        var pName = $('#name-' + pSsid).val();
                        var pDesc = $('#desc-' + pSsid).val();
                        var pCid = $('#fileColId-49-479-1-0-6_1').val() || '';
                        var instance = this.getInstance();

                        if (pSsid == '')
                            return false;

                        if (pName != "") {

                            if (source == 'paste' || source == 'autofill' || multicellUpdate == true) {

                                var cellChangesHdr = [];
                                var cellChangesUpd = [];
                                var cellChangesNew = [];

                                if (source == 'paste' || source == 'autofill')
                                    action = "copyPaste";
                                else if (multicellUpdate == true) /* Case for updating multiple rows by 'Select'  */
                                    action = 'multiRowsUpdate';

                                var chLength = changes.length - 1;
                                var minVal = changes[0][0];
                                var maxVal = changes[chLength][0];

                                for (var modifyRowIndex = minVal; modifyRowIndex <= maxVal; modifyRowIndex++) {

                                    var changedRow = modifyRowIndex;
                                    if ($.inArray(changedRow, newRowsIndexs) > -1) {
                                        if (changedRow == 0) {
                                            rowData = instance.getDataAtRow(changedRow);
                                            rowData.splice(1, 0, "", "");
                                            cellChangesHdr = rowData;
                                        } else {
                                            rowData = instance.getDataAtRow(changedRow);
                                            /* Get Solved value - if formula enabled on columns*/


                                            rowData.splice(1, 0, "", "");
                                            cellChangesNew.push(rowData);
                                        }
                                    } else {
                                        if (changedRow == 0) {
                                            rowData = instance.getDataAtRow(changedRow);
                                            rowData.splice(1, 0, "", "");
                                            cellChangesHdr = rowData;
                                        } else {
                                            rowData = instance.getDataAtRow(changedRow);
                                            /* Get Solved value - if formula enabled on columns*/



                                            rowData.splice(1, 0, "", "");
                                            cellChangesUpd.push(rowData);
                                        }
                                    }

                                }

                                var rowId = this.getDataAtCell(changedRow, 0);
                                var data = JSON.stringify({
                                    'data': {
                                        ssid: pSsid,
                                        action: "copyPaste",
                                        name: pName,
                                        desc: pDesc,
                                        hdrrows: cellChangesHdr,
                                        updrows: cellChangesUpd,
                                        newrows: cellChangesNew,
                                        row_id: rowId
                                    }
                                });

                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + pCid.split("#")[0] + $app.queryString(),
                                    data: data
                                });
                                newRowsIndexs = [];
                                multicellUpdate = false;

                                /*  Trigger workflow if change is on single row*/
                                if ((cellChangesNew.length + cellChangesUpd.length) == 1) {
                                    if ((cellChangesNew.length) == 1) {
                                        var wrkFlwRow = cellChangesNew[0];
                                    } else if ((cellChangesUpd.length) == 1) {
                                        var wrkFlwRow = cellChangesUpd[0];
                                    }

                                    for (var pChnKy in changes) {
                                        var pChangedInfo = changes[pChnKy];
                                        var fCol = pChangedInfo[1];
                                        if (fCol in hot3Conf['49-479-1-0-6_1'].settingsColEventConf) {
                                            /*   Trigger Event*/
                                            var colIndex = parseInt(fCol) + 2;
                                            var colValue = wrkFlwRow[colIndex];
                                            var wrkFlwId = hot3Conf['49-479-1-0-6_1'].settingsColEventConf[colIndex - 2]['eventparameter'];
                                            var Rowjson = Array;
                                            var Row = {};
                                            var jsonData = Array;
                                            /* append the column name to the values pair*/
                                            Rowjson = {}
                                            $.each(wrkFlwRow, function(key, value) {
                                                if (key > 2) {
                                                    key = key - 2;
                                                    var RowKey = hot3Conf['49-479-1-0-6_1'].xdata[0][key];
                                                    Rowjson[RowKey] = value;
                                                }
                                            });
                                            Rowjson['rowID'] = rowId;
                                            jsonData = [Rowjson];
                                            Row = {
                                                ssid: pSsid,
                                                action: 'event',
                                                row_id: wrkFlwRow[0],
                                                rows: Rowjson,
                                                selectedValues: wrkFlwRow
                                            };
                                            $.ajax({
                                                type: "POST",
                                                dataType: "json",
                                                url: "/workflow.init/" + wrkFlwId + "/" + pCid + $app.queryString(),
                                                data: { "data": JSON.stringify(jsonData) },
                                                success: function(data) {
                                                    $(document).trigger("workflowInQuee", [{ data: data, id: wrkFlwId }]);
                                                    $.each(data.Actions['messages'], function(i, item) {
                                                        $app.setMessage(item, i);
                                                    });
                                                }
                                            });

                                        }
                                    }
                                }

                            } else {
                                /*  SpreadSheet Edit Mode*/
                                var changedRow = changes[0][0];
                                var colIndex = changes[0][1];
                                var colValue = changes[0][3];

                                /* Appplying Formaula
                                check if the col has formual with it */
                                if (colValue) {
                                    if (colValue[0] === '=') {
                                        colValue = formulaSolver(colValue, instance, changedRow, colIndex);

                                    }
                                }
                                /*  Ends Formula Check */

                                if (colIndex == 0) {
                                    return false; /* Skip on hidden fields (rowId) changes*/
                                }

                                if ($.inArray(changedRow, newRowsIndexs) > -1) {
                                    action = 'rowInsert';
                                } else {
                                    action = 'rowUpdate';
                                }

                                var rowId = this.getDataAtCell(changedRow, 0);
                                var rowData = this.getDataAtRow(changedRow);
                                rowData.splice(1, 0, "", "");
                                colIndex = parseInt(colIndex) + 2;
                                var savePath = "/ls/livespace/spreadsheet.save/" + pCid.split("#")[0] + $app.queryString();
                                var data = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        rows: rowData,
                                        ssid: pSsid,
                                        action: action,
                                        col_index: colIndex,
                                        col_value: colValue,
                                        row_id: rowId
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: savePath,
                                    data: data
                                });
                                newRowsIndexs = [];

                                /*  Trigger Event*/
                                if (colIndex - 2 in hot3Conf['49-479-1-0-6_1'].settingsColEventConf) {
                                    var wrkFlwId = hot3Conf['49-479-1-0-6_1'].settingsColEventConf[colIndex - 2]['eventparameter'];
                                    var Rowjson = Array;
                                    var Row = {};
                                    var jsonData = Array;
                                    /*  append the column name to the values pair*/
                                    Rowjson = {}
                                    $.each(rowData, function(key, value) {
                                        if (key > 2) {
                                            key = key - 2;
                                            var RowKey = hot3Conf['49-479-1-0-6_1'].xdata[0][key];
                                            Rowjson[RowKey] = value;
                                        }
                                    });
                                    Rowjson['rowID'] = rowId;
                                    jsonData = [Rowjson];
                                    Row = {
                                        ssid: pSsid,
                                        action: 'event',
                                        row_id: rowId,
                                        rows: Rowjson,
                                        selectedValues: rowData
                                    };
                                    $.ajax({
                                        type: "POST",
                                        dataType: "json",
                                        url: "/workflow.init/" + wrkFlwId + "/" + pCid + $app.queryString(),
                                        data: { "data": JSON.stringify(jsonData) },
                                        success: function(data) {
                                            $(document).trigger("workflowInQuee", [{ data: data, id: wrkFlwId }]);
                                            $.each(data.Actions['messages'], function(i, item) {
                                                $app.setMessage(item, i);
                                            });
                                        }
                                    });
                                }

                            }

                        } else {
                            if (changes != null) {

                            }
                        }
                    },
                    beforeKeyDown: function(e) {
                        /*   Check Key for remove row action*/
                        if (e.keyCode === 46) {
                            lastKeyCode = 'delete';
                        }
                    },

                    beforeRemoveRow: function(index, amount) {
                        var rowIndex = index;
                        var rowData;
                        var rowId = [];
                        var Dconfirm = confirm("do you want to delete the row.");

                        /* ## Get RowId of selected row */
                        if (Dconfirm == false) {
                            return false;
                        }

                        for (var i = 0; i < amount; i++) {
                            if (i > 0)
                                rowIndex = (rowIndex + 1);

                            rowData = this.getDataAtCell(rowIndex, 0);
                            rowId.push(rowData);
                        }

                        var pSsid = "5b7275978b586b93007b2416-1-0-6_1";
                        var pName = $('#name-' + pSsid).val();

                        if (pSsid == '')
                            return false;

                        if (pName != "") {
                            var data = JSON.stringify({
                                'data': {
                                    ssid: pSsid,
                                    action: 'row_remove',
                                    row_id: rowId
                                }
                            });
                            $.ajax({
                                type: "POST",
                                dataType: 'json',
                                url: "/ls/livespace/spreadsheet.save/" + $app.queryString(),
                                data: data,
                                success: function() {
                                    var isRep;
                                    if ($('.container-fluid').hasClass('isLsSpreadSheet')) {
                                        isRep = $('.isLsSpreadSheet').find('#isReport').val();
                                    } else {
                                        isRep = $('.isLsSheet').find('#isReport').val();
                                    }

                                    if (isRep == '1') {
                                        var pGridViewEnabled = "";
                                        if (pGridViewEnabled == true) {} else
                                            fnApplyFilter();
                                        $(".filterByLiveapp").hide();
                                    } else {
                                        $(".previewTabSpread").trigger("shown.bs.tab");
                                    }
                                }
                            });
                        }

                    },
                    afterCreateRow: function(index, amount) {},
                    afterCreateCol: function(index, amount) {
                        var pSsid = "5b7275978b586b93007b2416-1-0-6_1";
                        var pName = $('#name-' + pSsid).val();

                        if (pSsid == '')
                            return false;

                        if (pName != "") {

                            var data = JSON.stringify({
                                'data': {
                                    ssid: pSsid,
                                    action: 'column_insert',
                                    col_pos: index + 2
                                }
                            });
                            $.ajax({
                                type: "POST",
                                dataType: 'json',
                                url: "/ls/livespace/spreadsheet.save/" + $app.queryString(),
                                data: data
                            }).success(function(rdata) {

                                $('a.previewTabSpread').trigger('shown.bs.tab');

                            });

                        }

                    },
                    beforeRemoveCol: function(index, amount) {
                        return confirm("Are you sure you want to delete this column. Deleting columns might cause data loss.");
                    },
                    afterRemoveCol: function(index, amount) {
                        var pSsid = "5b7275978b586b93007b2416-1-0-6_1";
                        var pName = $('#name-' + pSsid).val();

                        if (pSsid == '')
                            return false;

                        if (pName != "") {
                            var data = JSON.stringify({
                                'data': {
                                    ssid: pSsid,
                                    action: 'column_remove',
                                    col_pos: index + 2,
                                    num_of_columns: amount
                                }
                            });
                            $.ajax({
                                type: "POST",
                                dataType: 'json',
                                url: "/ls/livespace/spreadsheet.save/" + $app.queryString(),
                                data: data
                            }).success(function(rdata) {
                                $('a.previewTabSpread').trigger('shown.bs.tab');
                            });

                        }

                    }


                };


                function formulaSolver(colValue, instance, changedRow, colIndex) {
                    formula = colValue.substr(1).toUpperCase();

                    var cellId = instance.plugin.utils.translateCellCoords({
                        row: changedRow,
                        col: colIndex
                    })

                    var newValue = instance.plugin.parse(formula, {
                        row: changedRow,
                        col: colIndex,
                        id: cellId
                    });
                    error = newValue.error;
                    result = newValue.result;
                    if (error) {
                        /* clear cell value*/
                        if (!colValue) {
                            /*  reset error*/
                            error = null;
                        } else {
                            /*  show error*/
                            colValue = error;
                        }
                    } else {
                        colValue = result;
                    }

                    return colValue;

                };

                function generateTags(coords, TagrowID, DataAtCell, clolumnListArray, generalSettings, tagInstance) {
                    var Tagname = '';
                    var tagData = null;
                    for (var i in clolumnListArray) {
                        var cTagindex = clolumnListArray[i];
                        tagData = DataAtCell(coords.row, cTagindex);
                        if (tagData != null && $.trim(tagData)) {
                            tagData = $.trim($('<p> ' + tagData.toString() + ' </p>').text());
                            tagData = tagData.replace(/ /g, "_");
                            tagData = tagData.slice(0, 40);
                            if (tagData[0] === '=')
                                tagData = formulaSolver(tagData, tagInstance, coords.row, cTagindex);
                            Tagname = Tagname + ' ' + tagData;
                        }
                    }
                    if (Tagname != '' && $.trim(Tagname)) {
                        Tagname = Tagname.replace(/\//g, '_vSv_');
                        Tagname = Tagname.replace(/\#/g, '__vizHash__');
                        Tagname = Tagname.replace(/\%/g, '__vizPercent__');

                        var setUrl = window.location.pathname + $app.queryString();
                        if (window.location.toString().indexOf("#") != -1) {
                            setUrl = window.location.toString().split('#')[1];
                            setUrl = setUrl.split('?')[0];
                        }

                        if (setUrl.indexOf("rowId") >= 0 && setUrl.indexOf("ssId") >= 0) {
                            var tmpUrlSeg = setUrl.split("/rowId/");
                            setUrl = tmpUrlSeg[0];
                        }

                        var appId = $('#appsId').val();
                        var lsId = $('#uId').val() + '-' + $('#portalId').val();
                        var setngsssid = "5b7275978b586b93007b2416-1-0-6_1";
                        setngsssid = setngsssid.split('-')[0];
                        setUrl = setUrl + '/rowId/' + TagrowID + '/ssId/' + setngsssid + '/' + encodeURIComponent(Tagname) + $app.queryString();

                        $.fn.addBcastTag({
                            tag: Tagname,
                            url: setUrl,
                            ssid: setngsssid,
                            rowid: TagrowID,
                            appid: appId,
                            lsid: lsId,
                            type: 'spreadsheet'
                        });
                    }

                };


                /* Update Settings*/
                hot3['49-479-1-0-6_1'] = new Handsontable(container, sheetnew);
                hot3Id = '49-479-1-0-6_1';
                lapSS.push('49-479-1-0-6_1');
                /*  give a message if spreadsheet not saved after entering title..*/
                $('.d7975d38c745fea97f6855a8ad48544f').on('keypress, change', 'input.spreadsheet', function(event) {
                    if (event.keyCode == 13 || event.keyCode == 9 || event.type == "change") {
                        var pSsid = "5b7275978b586b93007b2416-1-0-6_1";
                        var pName = $('#name-' + pSsid).val();
                        var pDesc = $('#desc-' + pSsid).val();
                        var fileColId = $('#fileColId-49-479-1-0-6_1').val() || $('.isLsSpreadSheet').find($('[name="fileColId"]')).val();
                        if (pName != "" && $('a.spreadsheet').hasClass('saved') == false && pSsid == "") {
                            /*  Not saved*/
                            $app.setMessage("Please save spreadsheet", "warn");
                            return false;
                        }
                    }
                    if (pName != "" && pSsid != "") {

                        var tmpCntKey = $("#cntId").attr('data-cntKey');

                        /* SS Update meta*/
                        var data = JSON.stringify({
                            'data': {
                                name: pName,
                                desc: pDesc,
                                ssid: pSsid,
                                action: 'metaDataUpdate'
                            }
                        });
                        $.ajax({
                            type: "POST",
                            dataType: 'json',
                            url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                            data: data,
                            success: function(data) {
                                if (data.Result.message != null && data.Result.status == "failed") {
                                    $app.setMessage(data.Result.message, 'error');
                                }
                            }
                        });

                    }


                });


                $('.d7975d38c745fea97f6855a8ad48544f a.spreadsheet').on('click', function(event) {
                    var pSsid = "5b7275978b586b93007b2416-1-0-6_1";
                    var pName = $('#name-' + pSsid).val();
                    var pDesc = $('#desc-' + pSsid).val();
                    var fileColId = $('#fileColId-49-479-1-0-6_1').val() || "";
                    var tempRows = jQuery.extend(true, {}, hot3Conf['49-479-1-0-6_1'].SPdata);
                    if (tempRows[0][0] == "" || tempRows[0][0] == null) {
                        var i = Math.random();
                        var xrowId = $app.md5(xtid + xuid + "'" + $.now() + i + "'");
                        hot3['49-479-1-0-6_1'].setDataAtCell(0, 0, xrowId, 'insert');
                    }

                    if (pName != "") {
                        if ($(this).hasClass('saved') == false) {
                            /*    New SS insert */
                            if (pSsid == '') {
                                tempRows = jQuery.extend(true, {}, hot3Conf['49-479-1-0-6_1'].SPdata);
                                var pChangedRow = [];
                                $.each(tempRows, function(index, tRow) {
                                    if (tRow[0] != "" && tRow[0] != null) {
                                        tRow.splice(1, 0, "", "");
                                        pChangedRow.push(tRow);
                                    }
                                });

                                var pdata = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        rows: pChangedRow,
                                        ssid: pSsid,
                                        action: 'metaDataInsert'
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                                    data: pdata
                                }).success(function(rdata) {
                                    if ($('#ssid').val() == "") {
                                        if (rdata.Result.status == "success") {
                                            $('a.spreadsheet').remove();
                                            if (isRep == 'r') {
                                                $('button.spsheetsavebut').removeClass('hide');
                                            }
                                            $('#ssid').val(rdata.Result.sid.$id);
                                            var fileId = rdata.Result.colFileOwner;
                                            var fIdArray = fileId.split('-');
                                            var fid = fIdArray[1] + '-' + fIdArray[0] + '-' + fIdArray[2];
                                            $('input[name="fileColId"]').attr('id', 'fileColId-' + $('#ssid').val());
                                            $('input[name="name"]').attr('id', 'name-' + $('#ssid').val());
                                            $('input[name="desc"]').attr('id', 'desc-' + $('#ssid').val());
                                            $('#fileColId-' + $('#ssid').val()).val(fid);

                                            $app.setMessage(rdata.Result.message, "success");
                                        } else if (rdata.Result.status == "failed") {
                                            $app.setMessage(rdata.Result.message, "danger");
                                        }

                                    }

                                });

                            } else {
                                /* SS Update meta*/
                                var data = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        ssid: pSsid,
                                        action: 'metaDataUpdate'
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                                    data: data
                                });
                            }
                        }
                    } else {
                        $app.setMessage("Please enter title", "warn");
                    }
                    return false;

                });

                $('.d7975d38c745fea97f6855a8ad48544f button.closeModal').on('click', function() {
                    $('div.modal-header .close').trigger('click');
                });


                /* Save action for report*/
                $('.d7975d38c745fea97f6855a8ad48544f button.spsheetsavebut').on('click', function() {
                    var cntId;
                    if ($('.container-fluid').hasClass('isLsSpreadSheet')) {
                        cntId = $('.isLsSpreadSheet').find('#cntId').val();
                    } else {
                        cntId = $('.isLsSheet').find('#cntId').val();
                    }
                    if (isRep == 'r') {
                        /*  Add new ss inside dashboard widget*/
                        var pSsid = "5b7275978b586b93007b2416-1-0-6_1";
                        var pName = $('#name-' + pSsid).val();
                        var pDesc = $('#desc-' + pSsid).val();
                        var fileColId = $('#fileColId-49-479-1-0-6_1').val() || '';
                        if ($("#isAdded").val() == '') {
                            var title = pName;
                            if (pSsid == '') {
                                var tempRows = jQuery.extend(true, {}, hot3Conf['49-479-1-0-6_1'].SPdata);
                                var pChangedRow = [];
                                $.each(tempRows, function(index, tRow) {
                                    if (tRow[0] != "" && tRow[0] != null) {
                                        tRow.splice(1, 0, "", "");
                                        pChangedRow.push(tRow);
                                    }
                                });

                                var pdata = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        rows: pChangedRow,
                                        ssid: pSsid,
                                        action: 'metaDataInsert'
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                                    data: pdata
                                }).success(function(rdata) {
                                    if ($('#ssid').val() == "") {
                                        if (rdata.Result.status == "success") {
                                            $('a.spreadsheet').addClass("saved");
                                            $('#ssid').val(rdata.Result.sid.$id);
                                            var fileId = rdata.Result.colFileOwner;
                                            var fIdArray = fileId.split('-');

                                            var fid = fIdArray[1] + '#' + fIdArray[2] + '-' + cntId;
                                            $('#fileColId-' + $('#ssid').val()).val(fid);
                                            var wid = fIdArray[1] + '#' + fIdArray[2] + '-' + cntId;
                                            /*  For thumbnail*/
                                            var thumbnail = '/ui-themes/karma/images/svg/spreadsheet.svg';
                                            var templte = '<li><input type="checkbox" name="chk_files[]" id="chk_files_' + fid + '" class=" hide flo mr5 add-to-list" value="' + fid + '">';
                                            templte += '<div><input  name="widget[]" type="hidden" value="' + wid + '"/>';
                                            templte += ' <span class="drag ActionIcon label pull-right"><a  class=" mr10" title="Delete"><i class="fa fa-trash element-remove" title="Delete"></i></a></span> ';
                                            templte += ' <img width="20" height="20" border="0" class="flo ml10mr10" src="' + thumbnail + '"><span class="' + fid + '">' + title + '</span>';
                                            templte += '</div>';
                                            templte += '</li>';
                                            dataSet = {
                                                id: fid,
                                                title: title
                                            }
                                            console.log($('#ssid').val(rdata.Result.sid.$id));
                                            eTemplate = `<div class="actionItems"> 
                        <a><i class="fa fa-edit"></i></a><a><i class="fa fa-trash"></i></a>
                        <span class"oname">${dataSet.title}</span> 
                       </div>`;
                                            $('.tab-pane.active').find('.gs-w.active .objectAction').html($(eTemplate).data(dataSet));
                                            $("#isAdded").val('added');
                                            $(this).html('Update');
                                            $('.code-save-btn-app').trigger('click');
                                            $('div.modal-header .close').trigger('click');
                                        } else if (rdata.Result.status == "failed") {
                                            $app.setMessage(rdata.Result.message, "danger");
                                            return false;
                                        }
                                    }
                                });
                            } else {
                                /* Edit dashboard in Add excel case*/
                                var fileColId = $('#fileColId-' + pSsid).val();
                                var fIdArray = fileColId.split('-');
                                var fid = fIdArray[0] + '-' + fIdArray[2] + '-' + cntId;
                                var wid = fIdArray[0] + '#' + fIdArray[2] + '-' + cntId;
                                /*For thumbnail*/
                                var thumbnail = '/ui-themes/karma/images/svg/spreadsheet.svg';
                                var templte = '<li><input type="checkbox" name="chk_files[]" id="chk_files_' + fid + '" class=" hide flo mr5 add-to-list" value="' + fid + '">';
                                templte += '<div><input  name="widget[]" type="hidden" value="' + wid + '"/>';
                                templte += ' <span class="drag font_20 label pull-right">  <i  TITLE="Delete" class="icon-trash element-remove"></i> </span> ';
                                templte += ' <img width="20" height="20" border="0" class="flo mr10" src="' + thumbnail + '"><span class="' + fid + '">' + title + '</span>';
                                templte += '</div>';
                                templte += '</li>';
                                dataSet = {
                                    id: wid,
                                    title: title
                                }

                                console.log($('#ssid').val());
                                eTemplate = `<div class="actionItems"> 
                        <a><i class="fa fa-edit"></i></a><a><i class="fa fa-trash"></i></a>
                       </div>`;
                                $('.tab-pane.active').find('.gs-w.active .objectAction').html($(eTemplate).data(dataSet));
                                $('.tab-pane.active').find('.gs-w.active .tName').html(`<span class"oname">${dataSet.title}</span>`);
                                $('.tab-pane.active').find('.gs-w.active').data('id', dataSet.id);

                                $("#isAdded").val('added');
                                $('.code-save-btn-app').trigger('click');
                                $('div.modal-header .close').trigger('click');

                            }
                        } else {
                            /* Update SS title if change title from the dashboard edit*/
                            if (pSsid != '' && $("#isAdded").val() != '' && pName != "") {
                                /* Update SS title if change title from the dashboard edit
                                 SS Update meta*/

                                var title = pName;
                                var fileColId = $('#fileColId-' + pSsid).val();
                                var fIdArray = fileColId.split('-');

                                var fid = fIdArray[0] + '-' + fIdArray[2];
                                var data = JSON.stringify({
                                    'data': {
                                        name: pName,
                                        desc: pDesc,
                                        ssid: pSsid,
                                        action: 'metaDataUpdate'
                                    }
                                });
                                $.ajax({
                                    type: "POST",
                                    dataType: 'json',
                                    url: "/ls/livespace/spreadsheet.save/" + fileColId.split("#")[0] + $app.queryString(),
                                    data: data
                                });

                                $('.code-drop-region-app.active').find('span[class^=' + fid + ']').html(title);
                                /*     var widgetVal   = $('.code-drop-region-app.active').find('span[class^='+fid+']').closest('li>div').find('input[type=hidden]').val();
                                     if(widgetVal.indexOf('#VIZEFLAG')==-1)
                                       $('.code-drop-region-app.active').find('span[class^='+fid+']').closest('li>div').find('input[type=hidden]').val(widgetVal+"#VIZEFLAG");*/
                                $('.code-save-btn-app').trigger('click');
                                $('div.modal-header .close').trigger('click');
                            }

                        }


                    }
                    $("#isAdded").val('');
                    // $('#fileColId-49-479-1-0-6_1').val('');
                    $('#ssid').val('');
                });


                hot3['49-479-1-0-6_1'].render();
                setTimeout(function() { hot3['49-479-1-0-6_1'].render(); }, 1000);

                /* Validate all cells afterLoad*/
                var setngsssid = '49-479-1-0-6_1';
                var selectedColumnIndex = 1;
                var selectedColumn = ''; //get value after updating columnsettings only
                if (setngsssid == '') {
                    setngsssid = 0;
                }



                /*  $( "#ShowBroadcast" ).click(function() {
                    $('.ssarea').addClass('ssclass');
                    $('#rightPanSettings').hide();
                    
                  });*/

                $(".sidebar-close").click(function() {
                    $('.ssarea').removeClass('ssclass');
                    $('#rightPanSettings').show();
                    setTimeout(function() { hot3['49-479-1-0-6_1'].render(); }, 300);
                });

                $(".sidebar-close").click(function() {
                    setTimeout(function() { hot3['49-479-1-0-6_1'].render(); }, 300);
                });

                /* text Search on spreadsheet */
                $('.d7975d38c745fea97f6855a8ad48544f').on('keypress', '.ss-text-search', function(e) {
                    var key = e.which;
                    if (key == 13) {
                        var searchBtn = $(this).parent().find('.ss-text-search-btn');
                        searchBtn.trigger('click');
                        return false;
                    }
                });


                $('#sheet-49-479-1-0-6_1 .ht_master .wtHolder').ssAutoPaginate()



                $app.tid = 11;
                $app.domain = "mfin-uat.vizru.com";
                $('body').on('mouseover', '.filterByLiveapp', function() {

                    if ($('.filterbyitems .fltclsdash ').length < 1) {
                        $('.filterbyitems').hide();
                        $('body').removeClass('openitm');
                    }
                    if ($('.filterbyitems .fltclsdash ').length > 1) {
                        $('body').addClass('openitm');
                        $('.filterbyitems').show();
                    }
                    $('#rightPanFilter .filterclose').trigger('click');
                    //$('body').removeClass('openfl');
                    $('#content.isDash, .headerBelowButtonRight').removeClass('openfl');

                });
                $('body').on('click', '.filterbyitems .fltclsdash', function() {
                    $('.filterbyitems').show();
                });
            } catch (e) {
                console.log(e);
                $app.setError();
            }
        })($("body"));
    });
    $(function() { updateSelctGrp(2) })
    </script>
    <script type="text/javascript">
    var expire_time;
    var expiration = 60 * 60 * 3;

    function checkAndRedirect() { if (($.now() / 1000) > expire_time) { if (window.location.href.indexOf("user.signin") == -1) { window.location.href = "/user.signin"; } } setTimeout(checkAndRedirect, 2000); } $(function() {
        expire_time = ($.now() / 1000) + expiration;
        $(document).click(function() {
            if (($.now() / 1000) >= expire_time - (expiration / 2)) {
                $.get("ls/livespace.list");
                expire_time = ($.now() / 1000) + expiration;
            }
        }); /*   $(document).mousemove(function() {if (($.now()/1000) >= expire_time - (expiration/2)) {$.get("ls/livspace.list");expire_time = ($.now()/1000) + expiration;}}); */
        setTimeout(checkAndRedirect, 2000);
    });
    var base_path = window.location.protocol + "//" + window.location.host + "/";
    var nowactive = null;
    var hashurl = null;
    var hash = null;
    var vizruSocket;
    $(document).ready(function() {
        $app.tid = 11;
        if (window.location.hash != '#!') $app.load_content();
        $(window).bind('hashchange', function() { $app.load_content(); return false; });
        if ("https://mfin-uat.vizru.com:8000") {
       //  vizruSocket = $app.init({ "socket-server": "https://mfin-uat.vizru.com:8000" }); 
       } else { vizruSocket = { on: $.noop, emit: $.noop } }
    });
    </script>
</body>

</html>